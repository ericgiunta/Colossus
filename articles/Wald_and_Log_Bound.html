<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Confidence Interval Selection • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence Interval Selection">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Distrib_Starts.html">Distributed Start Framework</a></li>
    <li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Equation_Expression.html">Unified Equation Representation</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Confidence Interval Selection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/Wald_and_Log_Bound.Rmd" class="external-link"><code>vignettes/Wald_and_Log_Bound.Rmd</code></a></small>
      <div class="d-none name"><code>Wald_and_Log_Bound.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="available-methods">Available Methods<a class="anchor" aria-label="anchor" href="#available-methods"></a>
</h2>
<p>Colossus supports two methods of calculating a confidence interval
for model parameters for Cox proportional hazards models. The Wald
method and a likelihood-based bound method. This vignette will be
focused on the differences and what issues may arise.</p>
<div class="section level3">
<h3 id="wald-method">Wald Method<a class="anchor" aria-label="anchor" href="#wald-method"></a>
</h3>
<p>When Colossus finishes a Cox regression, it returns both parameter
estimates and standard errors. The simplest form of confidence interval
is assuming a normal distribution with the parameter mean and deviation.
The standard errors are calculated from the covariance matrix, which is
calculated as the negative inverse of the information matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>)
which is equal to the second derivative of Log-Likelihood.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>I</mi><mo>≈</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><msup><mover><mi>β</mi><mo accent="true">→</mo></mover><mn>2</mn></msup></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    I \approx \frac{\partial^2 LL}{\partial \vec{\beta}^2}
\end{aligned}
</annotation></semantics></math></p>
<p>For every row
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>)
if there is an event
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\delta_i=1</annotation></semantics></math>)
the second derivative is a function of the relative risk and derivatives
at the event row
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math>)
and the sum of relative risks and derivatives for every row at risk
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>,</mo><mi>D</mi><mo>,</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">C, D, E</annotation></semantics></math>)
based on the rows in each risk group
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>∈</mo><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l \in R_i</annotation></semantics></math>).</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>j</mi></msub><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>k</mi></msub></mrow></mfrac><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>δ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>*</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>*</mo><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mfrac><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><msub><mi>r</mi><mi>i</mi></msub></mrow><mrow><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>j</mi></msub><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>k</mi></msub></mrow></mfrac><msub><mi>r</mi><mi>i</mi></msub></mfrac><mo>,</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mfrac><mrow><mi>∂</mi><msub><mi>r</mi><mi>i</mi></msub></mrow><mrow><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>j</mi></msub></mrow></mfrac><msub><mi>r</mi><mi>i</mi></msub></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mfrac><mrow><munder><mo>∑</mo><mrow><mi>l</mi><mo>∈</mo><msub><mi>R</mi><mi>i</mi></msub></mrow></munder><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><msub><mi>r</mi><mi>l</mi></msub></mrow><mrow><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>j</mi></msub><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>k</mi></msub></mrow></mfrac></mrow><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo>,</mo><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mrow><mi>l</mi><mo>∈</mo><msub><mi>R</mi><mi>i</mi></msub></mrow></munder><mfrac><mrow><mi>∂</mi><msub><mi>r</mi><mi>l</mi></msub></mrow><mrow><mi>∂</mi><msub><mover><mi>β</mi><mo accent="true">→</mo></mover><mi>j</mi></msub></mrow></mfrac></mrow><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo>,</mo><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>l</mi><mo>∈</mo><msub><mi>R</mi><mi>i</mi></msub></mrow></munder><msub><mi>r</mi><mi>l</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \frac{\partial^2 LL}{\partial \vec{\beta}_j \partial \vec{\beta}_k} =&amp; \sum_{i=0}^N \left( \delta_i \left( (A_{i,j,k} - B_{i,j}*B_{i,k} ) - (C_{i,j,k} - D_{i,j}*D_{i,k} )  \right)\right)\\
    A_{i,j,k} =&amp; \frac{\frac{\partial^2 r_i}{\partial \vec{\beta}_j \partial \vec{\beta}_k}}{r_i}, B_{i,j} = \frac{\frac{\partial r_i}{\partial \vec{\beta}_j}}{r_i}\\
    C_{i,j,k} =&amp; \frac{\sum_{l \in R_i} \frac{\partial^2 r_l}{\partial \vec{\beta}_j \partial \vec{\beta}_k}}{E_i}, D_{i,j} = \frac{\sum_{l \in R_i} \frac{\partial r_l}{\partial \vec{\beta}_j}}{E_i}, E_{i} = \sum_{l \in R_i} r_l
\end{aligned}
</annotation></semantics></math></p>
<p>This gives a symmetric parameter confidence interval which is often
accurate for single term log-linear models. However this approximation
is often inaccurate for models with linear effects, particularly if the
confidence interval includes negative values. Because the Wald method
approximates the likelihood confidence interval, there is no guarantee
that the model is defined over the interval.</p>
</div>
<div class="section level3">
<h3 id="likelihood-based-bound">Likelihood-Based Bound<a class="anchor" aria-label="anchor" href="#likelihood-based-bound"></a>
</h3>
<p>The more exact solution is to directly solve for the boundary. The
basic premise is that the model can be optimized with a parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)
fixed. Each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
has a corresponding maximum log-likelihood. The confidence interval is
the range of values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
such that the maximum log-likelihood is above a threshold, taken from
the asymptotic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distribution of the generalized likelihood ratio test. Colossus uses the
Venzon-Moolgavkar algorithm to iteratively solve for the interval
endpoints.</p>
<p>There is one main issues that can arise from this method. The
algorithm uses a Newton-Raphson algorithm, which may solve for local
solutions instead of the global solution. Similar to the general
Colossus regressions, limitations can be placed on step size to limit
these effects. However, there is no analogue to selecting multiple
starting locations. This is the basis for ongoing work to code in an
alternative that can more directly solve for the true optimum.</p>
<p>This method directly solves for the confidence interval, which for
linear cases may be non-symmetric or even not have upper or lower
bounds. Linear models may be defined only above a parameter threshold.
If the optimum value at that parameter threshold is above the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
threshold value, then the interval would not have a lower bound.</p>
</div>
<div class="section level3">
<h3 id="example-and-comparison">Example and Comparison<a class="anchor" aria-label="anchor" href="#example-and-comparison"></a>
</h3>
<p>For the sake of comparison, we will consider an analysis of the
capacitor data available in the survival package. Consider the two
regressions, one fully exponential and one with a linear effect. Both
regressions converge with nearly identical scores.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">reliability</span>, package <span class="op">=</span> <span class="st">"survival"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">capacitor</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">voltage</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">voltage</span> <span class="op">-</span> <span class="fl">200</span><span class="op">)</span> <span class="op">/</span> <span class="fl">150</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">temperature</span> <span class="op">-</span> <span class="fl">170</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">-</span> <span class="fl">216</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1105</span> <span class="op">-</span> <span class="fl">216</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="st">"%trunc%"</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="st">"time"</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"status"</span></span>
<span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span>, <span class="st">"voltage"</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>, <span class="st">"loglin"</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Ncores"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"maxiter"</span> <span class="op">=</span> <span class="fl">100</span>, <span class="st">"verbose"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">fir</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression.html">RunCoxRegression</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">t0</span>, <span class="va">t1</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>, <span class="va">fir</span>, <span class="fl">0</span>, <span class="va">control</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e1</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;      Covariate Subterm Term Number Central Estimate Standard Deviation</span></span>
<span><span class="co">#&gt;         &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;              &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: temperature  loglin           0        0.7599511          0.3964440</span></span>
<span><span class="co">#&gt; 2:     voltage  loglin           0        1.9884051          0.6063097</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cox Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 210.77792,  AIC: 214.77792</span></span>
<span><span class="co">#&gt; Iterations run: 9</span></span>
<span><span class="co">#&gt; maximum step size: 1.00000e+00, maximum first derivative: 1.30641e-05</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in  0.067000150680542</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span>, <span class="st">"voltage"</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plin"</span>, <span class="st">"loglin"</span><span class="op">)</span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression.html">RunCoxRegression</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">t0</span>, <span class="va">t1</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>, <span class="va">fir</span>, <span class="fl">0</span>, <span class="va">control</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;      Covariate Subterm Term Number Central Estimate Standard Deviation</span></span>
<span><span class="co">#&gt;         &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;              &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: temperature    plin           0         1.138152          0.8476528</span></span>
<span><span class="co">#&gt; 2:     voltage  loglin           0         1.988403          0.6063095</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cox Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 210.77792,  AIC: 214.77792</span></span>
<span><span class="co">#&gt; Iterations run: 9</span></span>
<span><span class="co">#&gt; maximum step size: 1.00000e+00, maximum first derivative: 2.89872e-05</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in  0.0571284294128418</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
<p>Next suppose we were interested in the confidence intervals. Suppose
we want 95% confidence intervals for both the Wald and likelihood-based
boundaries and for both parameters in each model. Let us start with the
fully exponential model. The Wald boundary is estimated using the
central estimates and standard deviations. The Likelihood boundary is
solved using the “log_bound” option under the model control list. The
parameter number needs to be provided (indexed starting at zero) and an
alpha level needs to be provided. Overall the likelihood boundary were
all solved with scores within a narrow margin of the threshold. However
the boundaries are not exactly the same. The boundaries for temperature
are (-0.017, 1.537) and (-0.001, 1.560), and the boundaries for voltage
are (0.800, 3.177) and (0.841, 3.242). The two boundaries are off on the
scale of less than 0.1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span>, <span class="st">"voltage"</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>, <span class="st">"loglin"</span><span class="op">)</span></span>
<span><span class="va">ci_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">e1</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e1</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="va">e1</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e1</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ci_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">e1</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e1</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  <span class="va">e1</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e1</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7599511</span>, <span class="fl">1.9884051</span><span class="op">)</span></span>
<span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">fir</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"basic"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"maxstep"</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="st">"log_bound"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"alpha"</span> <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="st">"para_number"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"manual"</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Omnibus.html">RunCoxRegression_Omnibus</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">t0</span>, <span class="va">t1</span>, <span class="va">event</span>, <span class="va">names</span>,</span>
<span>  term_n <span class="op">=</span> <span class="va">term_n</span>,</span>
<span>  tform <span class="op">=</span> <span class="va">tform</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>,</span>
<span>  a_n <span class="op">=</span> <span class="va">a_n</span>, modelform <span class="op">=</span> <span class="va">modelform</span>, fir <span class="op">=</span> <span class="va">fir</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, model_control <span class="op">=</span> <span class="va">model_control</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"|------------------- Wald Estimate -------------------|"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "|------------------- Wald Estimate -------------------|"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.01707914  1.53698136</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Likelihood Boundary Results</span></span>
<span><span class="co">#&gt; Lower limit converged to at -0.0099 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Upper limit converged to at 1.55991 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Run finished in  0.06416916847229</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7599511</span>, <span class="fl">1.9884051</span><span class="op">)</span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"basic"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"maxstep"</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="st">"log_bound"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"alpha"</span> <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="st">"para_number"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"manual"</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Omnibus.html">RunCoxRegression_Omnibus</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">t0</span>, <span class="va">t1</span>, <span class="va">event</span>, <span class="va">names</span>,</span>
<span>  term_n <span class="op">=</span> <span class="va">term_n</span>,</span>
<span>  tform <span class="op">=</span> <span class="va">tform</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>,</span>
<span>  a_n <span class="op">=</span> <span class="va">a_n</span>, modelform <span class="op">=</span> <span class="va">modelform</span>, fir <span class="op">=</span> <span class="va">fir</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, model_control <span class="op">=</span> <span class="va">model_control</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"|------------------- Likelihood Bound Estimate -------------------|"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "|------------------- Likelihood Bound Estimate -------------------|"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.800038 3.176772</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Likelihood Boundary Results</span></span>
<span><span class="co">#&gt; Lower limit converged to at 0.84124 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Upper limit converged to at 3.24203 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Run finished in  0.0628185272216797</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
<p>Next we analyze a model with a linear effect. We would expect the
predictions to be further off. The boundaries for temperature are
(-0.522, 2.800) and (-0.010, 3.758), and the boundaries for voltage are
(0.800, 3.177) and (0.841, 3.242). The estimates for voltage boundary
are the same, but the estimates for the temperature boundary are much
further off.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span>, <span class="st">"voltage"</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plin"</span>, <span class="st">"loglin"</span><span class="op">)</span></span>
<span><span class="va">ci_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">e2</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e2</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="va">e2</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e2</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ci_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">e2</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e2</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  <span class="va">e2</span><span class="op">$</span><span class="va">beta_0</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">e2</span><span class="op">$</span><span class="va">Standard_Deviation</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.138152</span>, <span class="fl">1.988403</span><span class="op">)</span></span>
<span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">fir</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"basic"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"maxstep"</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="st">"log_bound"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"alpha"</span> <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="st">"para_number"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"manual"</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Omnibus.html">RunCoxRegression_Omnibus</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">t0</span>, <span class="va">t1</span>, <span class="va">event</span>, <span class="va">names</span>,</span>
<span>  term_n <span class="op">=</span> <span class="va">term_n</span>,</span>
<span>  tform <span class="op">=</span> <span class="va">tform</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>,</span>
<span>  a_n <span class="op">=</span> <span class="va">a_n</span>, modelform <span class="op">=</span> <span class="va">modelform</span>, fir <span class="op">=</span> <span class="va">fir</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, model_control <span class="op">=</span> <span class="va">model_control</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"|------------------- Wald Estimate -------------------|"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "|------------------- Wald Estimate -------------------|"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.5232476  2.7995516</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Likelihood Boundary Results</span></span>
<span><span class="co">#&gt; Lower limit converged to at -0.00984 at a score of -107.30967 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Upper limit converged to at 3.75837 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Run finished in  0.0646593570709229</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.138152</span>, <span class="fl">1.988403</span><span class="op">)</span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"basic"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"maxstep"</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="st">"log_bound"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"alpha"</span> <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="st">"para_number"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"manual"</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Omnibus.html">RunCoxRegression_Omnibus</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">t0</span>, <span class="va">t1</span>, <span class="va">event</span>, <span class="va">names</span>,</span>
<span>  term_n <span class="op">=</span> <span class="va">term_n</span>,</span>
<span>  tform <span class="op">=</span> <span class="va">tform</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>,</span>
<span>  a_n <span class="op">=</span> <span class="va">a_n</span>, modelform <span class="op">=</span> <span class="va">modelform</span>, fir <span class="op">=</span> <span class="va">fir</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, model_control <span class="op">=</span> <span class="va">model_control</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"|------------------- Wald Estimate -------------------|"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "|------------------- Wald Estimate -------------------|"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8000367 3.1767700</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Likelihood Boundary Results</span></span>
<span><span class="co">#&gt; Lower limit converged to at 0.84124 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Upper limit converged to at 3.24203 at a score of -107.30968 with of goal of -107.30969</span></span>
<span><span class="co">#&gt; Run finished in  0.0639746189117432</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="illustration-of-issues-with-likelihood-boundary-algorithm">Illustration of Issues with Likelihood-Boundary Algorithm<a class="anchor" aria-label="anchor" href="#illustration-of-issues-with-likelihood-boundary-algorithm"></a>
</h3>
<p>One important thing to keep in mind is that the likelihood-based
boundary algorithm is not perfect, and at times it may be important to
manually solve for the likelihood curve. The following example outlines
how this is done and what details about the curve can cause issues for
the boundary algorithm. The following uses a dataset used by Colossus
for unit testing. The linear parameter was selected for analysis. For
each point on a grid, the linear parameter was fixed and the model was
optimized.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="st">"base_example.csv"</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">fname</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="st">"entry"</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="st">"exit"</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"event"</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dose0"</span>, <span class="st">"dose1"</span>, <span class="st">"dose0"</span><span class="op">)</span></span>
<span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>, <span class="st">"loglin"</span>, <span class="st">"lin"</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.493177</span>, <span class="fl">5.020007</span>, <span class="fl">1.438377</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">fir</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">der_iden</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co">#</span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"ncores"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"lr"</span> <span class="op">=</span> <span class="fl">0.75</span>, <span class="st">"maxiters"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, <span class="st">"halfmax"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  <span class="st">"epsilon"</span> <span class="op">=</span> <span class="fl">1e-6</span>, <span class="st">"deriv_epsilon"</span> <span class="op">=</span> <span class="fl">1e-6</span>, <span class="st">"abs_max"</span> <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  <span class="st">"change_all"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"dose_abs_max"</span> <span class="op">=</span> <span class="fl">100.0</span>, <span class="st">"verbose"</span> <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="st">"ties"</span> <span class="op">=</span> <span class="st">"breslow"</span>, <span class="st">"double_step"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">v0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">50</span> <span class="op">/</span> <span class="fl">50</span> <span class="op">-</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">50</span> <span class="op">/</span> <span class="fl">50</span> <span class="op">*</span> <span class="fl">3</span>, <span class="fl">1.438377</span>, <span class="op">-</span><span class="fl">0.5909</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">v0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.493177</span>, <span class="fl">5.020007</span>, <span class="va">v</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Omnibus.html">RunCoxRegression_Omnibus</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>,</span>
<span>    term_n <span class="op">=</span> <span class="va">term_n</span>,</span>
<span>    tform <span class="op">=</span> <span class="va">tform</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>, a_n <span class="op">=</span> <span class="va">a_n</span>,</span>
<span>    modelform <span class="op">=</span> <span class="va">modelform</span>, fir <span class="op">=</span> <span class="va">fir</span>, der_iden <span class="op">=</span> <span class="va">der_iden</span>,</span>
<span>    control <span class="op">=</span> <span class="va">control</span>, model_control <span class="op">=</span> <span class="va">model_control</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">ll</span> <span class="op">&lt;-</span> <span class="va">e</span><span class="op">$</span><span class="va">LogLik</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">e</span><span class="op">$</span><span class="va">beta_0</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ll</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>What is important to note is that there are two local optimums within
a small range (-0.6 and the global solution at 1.4). The algorithms used
for solving the likelihood boundary, similar to the standard regression
optimizing algorithm, is trapped in local optimums. This means that if
the algorithm at any point has to cross over the local optimum, it can
be trapped. The two optimums are close enough in score that a 95%
confidence interval has a lower boundary below -0.5, but a 50%
confidence interval has a lower bound between -0.5 and 1.4. This meant
that the algorithm converged to the 50% confidence interval boundary,
but failed to converge for the lower boundary of the 95% confidence
interval boundary. Development is ongoing to automate the process for
solving the complete likelihood curve.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>, <span class="op">-</span><span class="fl">0.784</span>, <span class="op">-</span><span class="fl">0.768</span>, <span class="op">-</span><span class="fl">0.752</span>, <span class="op">-</span><span class="fl">0.736</span>, <span class="op">-</span><span class="fl">0.72</span>, <span class="op">-</span><span class="fl">0.704</span>, <span class="op">-</span><span class="fl">0.688</span>, <span class="op">-</span><span class="fl">0.672</span>, <span class="op">-</span><span class="fl">0.656</span>, <span class="op">-</span><span class="fl">0.64</span>, <span class="op">-</span><span class="fl">0.624</span>, <span class="op">-</span><span class="fl">0.608</span>, <span class="op">-</span><span class="fl">0.592</span>, <span class="op">-</span><span class="fl">0.5909</span>, <span class="op">-</span><span class="fl">0.576</span>, <span class="op">-</span><span class="fl">0.56</span>, <span class="op">-</span><span class="fl">0.544</span>, <span class="op">-</span><span class="fl">0.528</span>, <span class="op">-</span><span class="fl">0.512</span>, <span class="op">-</span><span class="fl">0.496</span>, <span class="op">-</span><span class="fl">0.48</span>, <span class="op">-</span><span class="fl">0.464</span>, <span class="op">-</span><span class="fl">0.448</span>, <span class="op">-</span><span class="fl">0.432</span>, <span class="op">-</span><span class="fl">0.416</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.384</span>, <span class="op">-</span><span class="fl">0.368</span>, <span class="op">-</span><span class="fl">0.352</span>, <span class="op">-</span><span class="fl">0.336</span>, <span class="op">-</span><span class="fl">0.32</span>, <span class="op">-</span><span class="fl">0.304</span>, <span class="op">-</span><span class="fl">0.288</span>, <span class="op">-</span><span class="fl">0.272</span>, <span class="op">-</span><span class="fl">0.256</span>, <span class="op">-</span><span class="fl">0.24</span>, <span class="op">-</span><span class="fl">0.224</span>, <span class="op">-</span><span class="fl">0.208</span>, <span class="op">-</span><span class="fl">0.192</span>, <span class="op">-</span><span class="fl">0.176</span>, <span class="op">-</span><span class="fl">0.16</span>, <span class="op">-</span><span class="fl">0.144</span>, <span class="op">-</span><span class="fl">0.128</span>, <span class="op">-</span><span class="fl">0.112</span>, <span class="op">-</span><span class="fl">0.096</span>, <span class="op">-</span><span class="fl">0.08</span>, <span class="op">-</span><span class="fl">0.064</span>, <span class="op">-</span><span class="fl">0.048</span>, <span class="op">-</span><span class="fl">0.032</span>, <span class="op">-</span><span class="fl">0.016</span>, <span class="fl">0.0</span>, <span class="fl">0.06</span>, <span class="fl">0.12</span>, <span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.3</span>, <span class="fl">0.36</span>, <span class="fl">0.42</span>, <span class="fl">0.48</span>, <span class="fl">0.54</span>, <span class="fl">0.6</span>, <span class="fl">0.66</span>, <span class="fl">0.72</span>, <span class="fl">0.78</span>, <span class="fl">0.84</span>, <span class="fl">0.9</span>, <span class="fl">0.96</span>, <span class="fl">1.02</span>, <span class="fl">1.08</span>, <span class="fl">1.14</span>, <span class="fl">1.2</span>, <span class="fl">1.26</span>, <span class="fl">1.32</span>, <span class="fl">1.38</span>, <span class="fl">1.438377</span>, <span class="fl">1.44</span>, <span class="fl">1.5</span>, <span class="fl">1.56</span>, <span class="fl">1.62</span>, <span class="fl">1.68</span>, <span class="fl">1.74</span>, <span class="fl">1.8</span>, <span class="fl">1.86</span>, <span class="fl">1.92</span>, <span class="fl">1.98</span>, <span class="fl">2.04</span>, <span class="fl">2.1</span>, <span class="fl">2.16</span>, <span class="fl">2.22</span>, <span class="fl">2.28</span>, <span class="fl">2.34</span>, <span class="fl">2.4</span>, <span class="fl">2.46</span>, <span class="fl">2.52</span>, <span class="fl">2.58</span>, <span class="fl">2.64</span>, <span class="fl">2.7</span>, <span class="fl">2.76</span>, <span class="fl">2.82</span>, <span class="fl">2.88</span>, <span class="fl">2.94</span>, <span class="fl">3.0</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18500.53</span>, <span class="op">-</span><span class="fl">18499.829</span>, <span class="op">-</span><span class="fl">18499.273</span>, <span class="op">-</span><span class="fl">18498.831</span>, <span class="op">-</span><span class="fl">18498.482</span>, <span class="op">-</span><span class="fl">18498.21</span>, <span class="op">-</span><span class="fl">18497.995</span>, <span class="op">-</span><span class="fl">18497.832</span>, <span class="op">-</span><span class="fl">18497.71</span>, <span class="op">-</span><span class="fl">18497.621</span>, <span class="op">-</span><span class="fl">18497.56</span>, <span class="op">-</span><span class="fl">18497.519</span>, <span class="op">-</span><span class="fl">18497.498</span>, <span class="op">-</span><span class="fl">18497.49</span>, <span class="op">-</span><span class="fl">18497.4904</span>, <span class="op">-</span><span class="fl">18497.495</span>, <span class="op">-</span><span class="fl">18497.51</span>, <span class="op">-</span><span class="fl">18497.53</span>, <span class="op">-</span><span class="fl">18497.558</span>, <span class="op">-</span><span class="fl">18497.589</span>, <span class="op">-</span><span class="fl">18497.624</span>, <span class="op">-</span><span class="fl">18497.66</span>, <span class="op">-</span><span class="fl">18497.7</span>, <span class="op">-</span><span class="fl">18497.739</span>, <span class="op">-</span><span class="fl">18497.779</span>, <span class="op">-</span><span class="fl">18497.818</span>, <span class="op">-</span><span class="fl">18497.86</span>, <span class="op">-</span><span class="fl">18497.896</span>, <span class="op">-</span><span class="fl">18497.933</span>, <span class="op">-</span><span class="fl">18497.969</span>, <span class="op">-</span><span class="fl">18498.003</span>, <span class="op">-</span><span class="fl">18498.04</span>, <span class="op">-</span><span class="fl">18498.067</span>, <span class="op">-</span><span class="fl">18498.096</span>, <span class="op">-</span><span class="fl">18498.124</span>, <span class="op">-</span><span class="fl">18498.15</span>, <span class="op">-</span><span class="fl">18498.17</span>, <span class="op">-</span><span class="fl">18498.196</span>, <span class="op">-</span><span class="fl">18498.216</span>, <span class="op">-</span><span class="fl">18498.235</span>, <span class="op">-</span><span class="fl">18498.252</span>, <span class="op">-</span><span class="fl">18498.27</span>, <span class="op">-</span><span class="fl">18498.281</span>, <span class="op">-</span><span class="fl">18498.292</span>, <span class="op">-</span><span class="fl">18498.303</span>, <span class="op">-</span><span class="fl">18498.311</span>, <span class="op">-</span><span class="fl">18498.32</span>, <span class="op">-</span><span class="fl">18498.324</span>, <span class="op">-</span><span class="fl">18498.329</span>, <span class="op">-</span><span class="fl">18498.332</span>, <span class="op">-</span><span class="fl">18498.334</span>, <span class="op">-</span><span class="fl">18498.33</span>, <span class="op">-</span><span class="fl">18498.33</span>, <span class="op">-</span><span class="fl">18498.31</span>, <span class="op">-</span><span class="fl">18498.27</span>, <span class="op">-</span><span class="fl">18498.23</span>, <span class="op">-</span><span class="fl">18498.18</span>, <span class="op">-</span><span class="fl">18498.13</span>, <span class="op">-</span><span class="fl">18498.07</span>, <span class="op">-</span><span class="fl">18498.01</span>, <span class="op">-</span><span class="fl">18497.96</span>, <span class="op">-</span><span class="fl">18497.9</span>, <span class="op">-</span><span class="fl">18497.84</span>, <span class="op">-</span><span class="fl">18497.78</span>, <span class="op">-</span><span class="fl">18497.73</span>, <span class="op">-</span><span class="fl">18497.68</span>, <span class="op">-</span><span class="fl">18497.63</span>, <span class="op">-</span><span class="fl">18497.59</span>, <span class="op">-</span><span class="fl">18497.56</span>, <span class="op">-</span><span class="fl">18497.52</span>, <span class="op">-</span><span class="fl">18497.49</span>, <span class="op">-</span><span class="fl">18497.47</span>, <span class="op">-</span><span class="fl">18497.45</span>, <span class="op">-</span><span class="fl">18497.44</span>, <span class="op">-</span><span class="fl">18497.43</span>, <span class="op">-</span><span class="fl">18497.429487</span>, <span class="op">-</span><span class="fl">18497.43</span>, <span class="op">-</span><span class="fl">18497.43</span>, <span class="op">-</span><span class="fl">18497.44</span>, <span class="op">-</span><span class="fl">18497.45</span>, <span class="op">-</span><span class="fl">18497.47</span>, <span class="op">-</span><span class="fl">18497.5</span>, <span class="op">-</span><span class="fl">18497.52</span>, <span class="op">-</span><span class="fl">18497.56</span>, <span class="op">-</span><span class="fl">18497.6</span>, <span class="op">-</span><span class="fl">18497.64</span>, <span class="op">-</span><span class="fl">18497.69</span>, <span class="op">-</span><span class="fl">18497.74</span>, <span class="op">-</span><span class="fl">18497.8</span>, <span class="op">-</span><span class="fl">18497.86</span>, <span class="op">-</span><span class="fl">18497.93</span>, <span class="op">-</span><span class="fl">18498.0</span>, <span class="op">-</span><span class="fl">18498.07</span>, <span class="op">-</span><span class="fl">18498.15</span>, <span class="op">-</span><span class="fl">18498.23</span>, <span class="op">-</span><span class="fl">18498.32</span>, <span class="op">-</span><span class="fl">18498.41</span>, <span class="op">-</span><span class="fl">18498.5</span>, <span class="op">-</span><span class="fl">18498.6</span>, <span class="op">-</span><span class="fl">18498.7</span>, <span class="op">-</span><span class="fl">18498.81</span>, <span class="op">-</span><span class="fl">18498.92</span>, <span class="op">-</span><span class="fl">18499.03</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">1</span>, <span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Linear Parameter Value"</span>, y <span class="op">=</span> <span class="st">"Log-Likelihood"</span><span class="op">)</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Wald_and_Log_Bound_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="likelihood-boundary-algorithm-alternative">Likelihood Boundary Algorithm Alternative<a class="anchor" aria-label="anchor" href="#likelihood-boundary-algorithm-alternative"></a>
</h3>
<p>As an alternative to the likelihood algorithm, a direct curve solving
method is implemented. The CoxCurveSolver function solves for the
boundary values by iteratively optimizing points and using the bisection
method. Each step is approximately as fast as running a single
regression. The same model_control options are used to select which
parameter is selected and what alpha to use, but adds an additional
option “step_size” which is the default search window width used. The
bisection method functions by (1) selecting an interval, (2) optimizing
at the upper, lower, and midpoint of the interval, and (3) checking if
the goal likelihood is crossed. If at-least one of the interval points
are on each side of the goal then the interval is narrowed, and if not
then the interval is shifted away from the optimum.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="st">"base_example.csv"</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">fname</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="st">"entry"</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="st">"exit"</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"event"</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dose0"</span>, <span class="st">"dose1"</span>, <span class="st">"dose0"</span><span class="op">)</span></span>
<span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>, <span class="st">"loglin"</span>, <span class="st">"lin"</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.493177</span>, <span class="fl">5.020007</span>, <span class="fl">1.438377</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">fir</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">der_iden</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co">#</span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"ncores"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"lr"</span> <span class="op">=</span> <span class="fl">0.75</span>, <span class="st">"maxiters"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, <span class="st">"halfmax"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  <span class="st">"epsilon"</span> <span class="op">=</span> <span class="fl">1e-6</span>, <span class="st">"deriv_epsilon"</span> <span class="op">=</span> <span class="fl">1e-6</span>, <span class="st">"abs_max"</span> <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  <span class="st">"change_all"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"dose_abs_max"</span> <span class="op">=</span> <span class="fl">100.0</span>, <span class="st">"verbose"</span> <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="st">"ties"</span> <span class="op">=</span> <span class="st">"breslow"</span>, <span class="st">"double_step"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"basic"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"maxstep"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"log_bound"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"alpha"</span> <span class="op">=</span> <span class="fl">0.005</span>, <span class="st">"para_num"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"step_size"</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoxCurveSolver.html">CoxCurveSolver</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>, term_n <span class="op">=</span> <span class="va">term_n</span>, tform <span class="op">=</span> <span class="va">tform</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>, a_n <span class="op">=</span> <span class="va">a_n</span>, modelform <span class="op">=</span> <span class="va">modelform</span>, fir <span class="op">=</span> <span class="va">fir</span>, der_iden <span class="op">=</span> <span class="va">der_iden</span>, control <span class="op">=</span> <span class="va">control</span>, strat_col <span class="op">=</span> <span class="st">"nan"</span>, model_control <span class="op">=</span> <span class="va">model_control</span><span class="op">)</span></span></code></pre></div>
<p>In summary there are three functions available for calculating
likelihood based boundaries. The first method is the standard
Venzon-Moolgavkar algorithm. This method attempts to both optimize the
model and guide the desired parameter to the boundary value. This method
is the fastest, but most susceptible to local extrema. Using this
algorithm depends on the initial step not being close to a local
extrema, so the initial step can be scaled up or down. The second method
is a modification of the Venzon-Moolgavkar algorithm. In the second
method the initial step is split into multiple guesses, and each guess
is optimized independently. The Venzon-Moolgavkar algorithm is then
continued at the closest guess that did not exceed the target
likelihood. In theory this method makes it more likely for the algorithm
to start at an appropriate point, so it is slower but slightly less
susceptible to local extrema. However the final portion of the algorithm
is still based on derivatives, so it still susceptible to local extrema.
The third method is an iterative bisection method. In this algorithm the
desired parameter is fixed, and the model is optimized at the endpoints
of an interval until an interval is located which contains the goal
likelihood. Then the interval is split in half until the interval width
is within a user-set limit. This method takes advantage of the fact that
the likelihood curve is continuous and we know that the optimum point
must be above the goal. The algorithm is split into two steps:
optimizing the model at fixed points and determining if the interval
contains the goal. The second step does not depend on the likelihood
derivatives, so it is not prone to getting stuck in local extrema.
However the interval width must be small enough not to step over the
solution. Given a small enough interval width, every optimization is
likely to converge and the solution is unlikely to be skipped. This
method requires the model to be optimized repeatedly, so it is expected
to take the longest. However the bisection method is the least likely to
have issues converging.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
