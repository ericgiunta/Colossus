<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Gradient and Hessian Approaches • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gradient and Hessian Approaches">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Equation_Expression.html">Unified Equation Representation</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Logistic.html">Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Matched_Case_Control.html">Matched Case-Control Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gradient and Hessian Approaches</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/Grad_Hess.Rmd" class="external-link"><code>vignettes/Grad_Hess.Rmd</code></a></small>
      <div class="d-none name"><code>Grad_Hess.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"OMP_THREAD_LIMIT"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Reducing core use, to avoid accidental use of too many cores</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="optimization-theory">Optimization Theory<a class="anchor" aria-label="anchor" href="#optimization-theory"></a>
</h2>
<p>Colossus offers three levels of score calculation, calculating only
the score, calculating the score and first derivative, and calculating
the score and both first and second derivatives. The second and third
options correspond to the Gradient Descent and Newton-Raphson
optimization approaches. The goal of this vignette is to discuss how
these methods are different, and in what circumstances each might be
most appropriate. In both cases, the algorithm is designed to
iteratively change the parameter estimates to approach a set of
parameter values that optimize the score. The major difference is how
much information is being calculated and used. The Newton-Raphson
algorithm calculates the second derivative matrix, inverts it, and
solves a linear system of equations to set the first derivative vector
to zero. This method establishes both a magnitude and direction for
every step. So every step has several time-intensive calculations, but
the new parameter estimates are informed. In this algorithm, Colossus
uses both a learning rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>)
and maximum allowable parameter change
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{max}</annotation></semantics></math>).
Colossus uses half-steps to slowly reduce the allowable step size as the
solution approaches the optimum.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><mi>β</mi><mo>×</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><msup><mi>β</mi><mn>2</mn></msup></mrow></mfrac><mo>≈</mo><mo>−</mo><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><mi>β</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><mi>β</mi><mo>=</mo><mo>−</mo><mi>η</mi><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><msub><mi>β</mi><mi>t</mi></msub></mrow></mfrac><mo>×</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><msubsup><mi>β</mi><mi>t</mi><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Δ</mi><mi>β</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \Delta \beta \times \frac{\partial^2 LL}{\partial \beta^2} \approx - \frac{\partial LL}{\partial \beta} \\
    \Delta \beta = - \eta \frac{\partial LL}{\partial \beta_{t}} \times \left ( \frac{\partial^2 LL}{\partial \beta_{t}^2} \right)^{-1} \\
    \beta_{t+1} = \beta_{t} + sign(\Delta \beta)*min \left( \left[ \left|\Delta \beta \right|, \beta_{max} \right] \right)
\end{aligned}
</annotation></semantics></math></p>
<p>The alternative is a Gradient descent approach. In this algorithm,
the first derivatives are calculated and used to determine the vector
with the highest change in score. This establishes a direction for the
change in parameters, which is multiplied by the learning rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>).
Similar to the Newton-Raphson algorithm, the magnitude is limited by a
maximum allowable parameter change
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{max}</annotation></semantics></math>).
The Gradient algorithm avoids the time-intensive second-derivative
calculations but takes less informed steps. So each iteration runs
faster, but more iterations may be required.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><mi>β</mi><mo>=</mo><mi>η</mi><mo>*</mo><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><mi>β</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Δ</mi><mi>β</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
   \Delta \beta = \eta * \frac{\partial LL}{\partial \beta}\\
   \beta_{t+1} = \beta_{t} + sign(\Delta \beta)*min \left( \left[ \left|\Delta \beta \right|, \beta_{max} \right] \right)
\end{aligned}
</annotation></semantics></math></p>
<p>The standard half-step framework is not likely to be sufficient for
the Gradient descent algorithm. Because of this, several different
optimization options have been added: momentum, adadelta, and adam. Each
use previous information about the gradient to inform the step size for
future steps.</p>
<p>The first method, momentum, applies a weighted sum
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>)
of the current and the previous step. This is done to speed up steps
moving toward the optimum position and correct for when the algorithm
oversteps. This can avoid the issue of oscillation around an optimum
value.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><mi>γ</mi><mo>*</mo><mi>Δ</mi><msub><mi>β</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><mo>*</mo><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><mi>β</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
   \Delta \beta_{t} = \gamma * \Delta \beta_{t-1} + \eta * \frac{\partial LL}{\partial \beta}\\
   \beta_{t+1} = \beta_{t} + sign(\Delta \beta_{t})*min \left( \left[ \left|\Delta \beta_{t} \right|, \beta_{max} \right] \right)
\end{aligned}
</annotation></semantics></math></p>
<p>The next method, the adadelta method, applies a parameter-specific
learning rate by tracking the root mean square (RMS) gradient and
parameter updates within a window. Instead of tracking a true window of
iteration, the old estimate of RMS is decayed by a weight
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>)
before being added to the new estimate. The ratio of RMS parameter
update to RMS gradient is used to normalize the results back in the
correct units. A small offset
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>)
is used to avoid the case of division by zero.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>g</mi><mi>t</mi></msub><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><mi>β</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>g</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msub><mo>=</mo><mi>γ</mi><mo>*</mo><mi>E</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>g</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>Δ</mi><msup><mi>β</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>γ</mi><mo>*</mo><mi>E</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>Δ</mi><msup><mi>β</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>Δ</mi><msubsup><mi>β</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>g</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msub><mo>=</mo><msqrt><mrow><mi>E</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>g</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msub><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>Δ</mi><mi>β</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msqrt><mrow><mi>E</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>Δ</mi><msup><mi>β</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><mfrac><mrow><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>Δ</mi><mi>β</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>g</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msub></mrow></mfrac><mo>*</mo><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    g_t = \left (\frac{\partial LL}{\partial \beta} \right)_{t} \\
    E[g^2]_{t} = \gamma * E[g^2]_{t-1} + (1-\gamma) * g^2_{t} \\
    E[\Delta \beta^2]_{t-1} = \gamma * E[\Delta \beta^2]_{t-2} + (1-\gamma) * \Delta \beta^2_{t-1} \\
    RMS[g]_t = \sqrt{E[g^2]_{t} + \epsilon} \\
    RMS[\Delta \beta]_{t-1} = \sqrt{E[\Delta \beta^2]_{t-1} + \epsilon} \\
   \Delta \beta_{t} = \frac{RMS[\Delta \beta]_{t-1}}{RMS[g]_t} * g_t\\
   \beta_{t+1} = \beta_{t} + sign(\Delta \beta_{t})*min \left( \left[ \left|\Delta \beta_{t} \right|, \beta_{max} \right] \right)
\end{aligned}
</annotation></semantics></math></p>
<p>The final method, adam, combines the theory behind the momentum and
adadelta methods. The adam method tracks an estimate of the first moment
vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>)
and second moment vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>),
which are weighted by decay parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1, \beta_2</annotation></semantics></math>).
These are bias corrected to correct for bias in early iterations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>,</mo><mover><mi>v</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\hat{m}, \hat{v}</annotation></semantics></math>).
The learning rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>)
and second moment vector provide the decaying learning rate from
adadelta, and the first moment vector provides an effect similar to
momentum. Combined, these have generally been able to stabilize gradient
descent algorithms without incurring a significant computational
cost.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>g</mi><mi>t</mi></msub><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>L</mi></mrow><mrow><mi>∂</mi><mi>β</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>m</mi><mn>0</mn></msub><mo>,</mo><msub><mi>v</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo>,</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>m</mi><mi>t</mi></msub><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><mo>*</mo><msub><mi>m</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><mo>*</mo><msub><mi>v</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mover><mi>m</mi><mo accent="true">̂</mo></mover><mi>t</mi></msub><mo>=</mo><msub><mi>m</mi><mi>t</mi></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mover><mi>v</mi><mo accent="true">̂</mo></mover><mi>t</mi></msub><mo>=</mo><msub><mi>v</mi><mi>t</mi></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>2</mn><mi>t</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><mfrac><mi>η</mi><mrow><msqrt><msub><mover><mi>v</mi><mo accent="true">̂</mo></mover><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac><mo>*</mo><msub><mover><mi>m</mi><mo accent="true">̂</mo></mover><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>Δ</mi><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo><msub><mi>β</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    g_t = \left (\frac{\partial LL}{\partial \beta} \right)_{t} \\
    m_0, v_0 = 0, 0 \\
    m_t = \beta_1 * m_{t-1} + (1-\beta_1) * g_t \\
    v_t = \beta_2 * v_{t-1} + (1-\beta_2) * g^2_t \\
    \hat{m}_t = m_t / (1-\beta_1^t) \\
    \hat{v}_t = v_t / (1-\beta_2^t) \\
   \Delta \beta_{t} = \frac{\eta}{\sqrt{\hat{v}_t} + \epsilon} * \hat{m}_t \\
   \beta_{t+1} = \beta_{t} + sign(\Delta \beta_{t})*min \left( \left[ \left|\Delta \beta_{t} \right|, \beta_{max} \right] \right)
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="use-in-practice">Use in Practice<a class="anchor" aria-label="anchor" href="#use-in-practice"></a>
</h2>
<p>The first thing to acknowledge is that the gradient descent method
may require more hyperparameter tuning than the standard Newton-Raphson
method. In general, it may be necessary to run the analysis multiple
times with different learning rates, decay terms, and offsets. The
following test example shows the basic usage with a simple model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="st">"tests/testthat/ll_comp_0.csv"</span></span>
<span><span class="va">colTypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"double"</span>, <span class="st">"double"</span>, <span class="st">"double"</span>, <span class="st">"integer"</span>, <span class="st">"integer"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">fname</span>, nThread <span class="op">=</span> <span class="fl">1</span>, data.table <span class="op">=</span> <span class="cn">TRUE</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, colClasses <span class="op">=</span> <span class="va">colTypes</span>, verbose <span class="op">=</span> <span class="fl">2</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3742</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">rand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Code not run due to duration</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"momentum"</span>, <span class="st">"adadelta"</span>, <span class="st">"adam"</span>, <span class="st">"gradient"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gradient_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"epsilon_decay"</span> <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span>
<span>  <span class="va">gradient_control</span><span class="op">[[</span><span class="va">method</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"ncores"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"lr"</span> <span class="op">=</span> <span class="fl">0.2</span>, <span class="st">"maxiters"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    <span class="st">"halfmax"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"epsilon"</span> <span class="op">=</span> <span class="fl">1e-6</span>,</span>
<span>    <span class="st">"deriv_epsilon"</span> <span class="op">=</span> <span class="fl">1e-6</span>, <span class="st">"verbose"</span> <span class="op">=</span> <span class="fl">4</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoxRun.html">CoxRun</a></span><span class="op">(</span><span class="fu">Cox</span><span class="op">(</span><span class="va">t0</span>, <span class="va">t1</span>, <span class="va">lung</span><span class="op">)</span> <span class="op">~</span> <span class="fu">loglinear</span><span class="op">(</span><span class="va">dose</span>, <span class="va">rand</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">m</span><span class="op">(</span><span class="op">)</span>, <span class="va">df</span>,</span>
<span>    a_n <span class="op">=</span> <span class="va">a_n</span>, keep_constant <span class="op">=</span> <span class="va">keep_constant</span>,</span>
<span>    control <span class="op">=</span> <span class="va">control</span>, gradient_control <span class="op">=</span> <span class="va">gradient_control</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Every gradient descent algorithm available was tested at the same
starting point. In all cases, the algorithm approaches the solution at
different rates. In this case, there are no local extrema, so the
standard approach is fine. These show some fundamental differences
between the methods. The effect of momentum is apparent compared to the
standard option, the estimates do not oscillate as quickly. The
differences between adadelta and adam are also visible, the adam method
converged quicker. These results did not necessarily use optimized
hyperparameters, and this is not meant to prove which method was the
best.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.446528</span>, <span class="fl">0.839821</span>, <span class="fl">0.493552</span>, <span class="fl">0.799313</span>, <span class="fl">0.528609</span>, <span class="fl">0.768118</span>, <span class="fl">0.555872</span>, <span class="fl">0.743827</span>, <span class="fl">0.577191</span>, <span class="fl">0.724839</span>, <span class="fl">0.593904</span>, <span class="fl">0.70996</span>, <span class="fl">0.607026</span>, <span class="fl">0.698284</span>, <span class="fl">0.617337</span>, <span class="fl">0.689114</span>, <span class="fl">0.625445</span>, <span class="fl">0.681907</span>, <span class="fl">0.631822</span>, <span class="fl">0.67624</span>, <span class="fl">0.67624</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.446528</span>, <span class="fl">0.431696</span>, <span class="fl">0.834161</span>, <span class="fl">0.857333</span>, <span class="fl">0.501858</span>, <span class="fl">0.477865</span>, <span class="fl">0.793264</span>, <span class="fl">0.814217</span>, <span class="fl">0.531039</span>, <span class="fl">0.511871</span>, <span class="fl">0.770217</span>, <span class="fl">0.78877</span>, <span class="fl">0.55277</span>, <span class="fl">0.530413</span>, <span class="fl">0.745479</span>, <span class="fl">0.771659</span>, <span class="fl">0.578773</span>, <span class="fl">0.54938</span>, <span class="fl">0.72037</span>, <span class="fl">0.750178</span>, <span class="fl">0.750178</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.0683777</span>, <span class="op">-</span><span class="fl">0.0236573</span>, <span class="fl">0.0204036</span>, <span class="fl">0.0631351</span>, <span class="fl">0.104199</span>, <span class="fl">0.143407</span>, <span class="fl">0.180661</span>, <span class="fl">0.215914</span>, <span class="fl">0.249159</span>, <span class="fl">0.280419</span>, <span class="fl">0.309735</span>, <span class="fl">0.337162</span>, <span class="fl">0.362769</span>, <span class="fl">0.386631</span>, <span class="fl">0.408828</span>, <span class="fl">0.429444</span>, <span class="fl">0.448562</span>, <span class="fl">0.466269</span>, <span class="fl">0.482647</span>, <span class="fl">0.497779</span>, <span class="fl">0.511745</span>, <span class="fl">0.511745</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.0999967</span>, <span class="fl">0.299992</span>, <span class="fl">0.49416</span>, <span class="fl">0.672686</span>, <span class="fl">0.818272</span>, <span class="fl">0.912721</span>, <span class="fl">0.951325</span>, <span class="fl">0.943139</span>, <span class="fl">0.900966</span>, <span class="fl">0.836339</span>, <span class="fl">0.759197</span>, <span class="fl">0.678706</span>, <span class="fl">0.6037</span>, <span class="fl">0.542181</span>, <span class="fl">0.50002</span>, <span class="fl">0.479848</span>, <span class="fl">0.481022</span>, <span class="fl">0.500511</span>, <span class="fl">0.53392</span>, <span class="fl">0.576232</span>, <span class="fl">0.622276</span>, <span class="fl">0.622276</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span>, <span class="st">"method"</span> <span class="op">=</span> <span class="va">c</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, group <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">method</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Iteration"</span>, y <span class="op">=</span> <span class="st">"First Parameter Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"First Parameter Value Convergence"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ggplot2 wasn't detected. Please install to see the plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Grad_Hess_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.382267</span>, <span class="fl">0.481728</span>, <span class="fl">0.371577</span>, <span class="fl">0.474396</span>, <span class="fl">0.383262</span>, <span class="fl">0.464408</span>, <span class="fl">0.392812</span>, <span class="fl">0.456452</span>, <span class="fl">0.40023</span>, <span class="fl">0.45019</span>, <span class="fl">0.406007</span>, <span class="fl">0.445259</span>, <span class="fl">0.41052</span>, <span class="fl">0.441374</span>, <span class="fl">0.414052</span>, <span class="fl">0.438314</span>, <span class="fl">0.416821</span>, <span class="fl">0.435902</span>, <span class="fl">0.418993</span>, <span class="fl">0.434002</span>, <span class="fl">0.420699</span>, <span class="fl">0.420699</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.382267</span>, <span class="fl">0.481728</span>, <span class="fl">0.461092</span>, <span class="fl">0.353981</span>, <span class="fl">0.381487</span>, <span class="fl">0.499642</span>, <span class="fl">0.486223</span>, <span class="fl">0.365388</span>, <span class="fl">0.35904</span>, <span class="fl">0.467404</span>, <span class="fl">0.490215</span>, <span class="fl">0.404434</span>, <span class="fl">0.37681</span>, <span class="fl">0.439266</span>, <span class="fl">0.459563</span>, <span class="fl">0.412495</span>, <span class="fl">0.405195</span>, <span class="fl">0.44752</span>, <span class="fl">0.445014</span>, <span class="fl">0.399118</span>, <span class="fl">0.404763</span>, <span class="fl">0.404763</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.0683799</span>, <span class="op">-</span><span class="fl">0.0236649</span>, <span class="fl">0.0193058</span>, <span class="fl">0.0594837</span>, <span class="fl">0.0964731</span>, <span class="fl">0.130195</span>, <span class="fl">0.160739</span>, <span class="fl">0.188284</span>, <span class="fl">0.213051</span>, <span class="fl">0.235278</span>, <span class="fl">0.255201</span>, <span class="fl">0.273049</span>, <span class="fl">0.289032</span>, <span class="fl">0.303346</span>, <span class="fl">0.316169</span>, <span class="fl">0.327659</span>, <span class="fl">0.337961</span>, <span class="fl">0.347201</span>, <span class="fl">0.355493</span>, <span class="fl">0.36294</span>, <span class="fl">0.36963</span>, <span class="fl">0.36963</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.0999917</span>, <span class="fl">0.299977</span>, <span class="fl">0.469249</span>, <span class="fl">0.559129</span>, <span class="fl">0.571139</span>, <span class="fl">0.537754</span>, <span class="fl">0.485171</span>, <span class="fl">0.434002</span>, <span class="fl">0.399975</span>, <span class="fl">0.38974</span>, <span class="fl">0.400107</span>, <span class="fl">0.422011</span>, <span class="fl">0.444253</span>, <span class="fl">0.456706</span>, <span class="fl">0.453734</span>, <span class="fl">0.435816</span>, <span class="fl">0.40853</span>, <span class="fl">0.380544</span>, <span class="fl">0.36118</span>, <span class="fl">0.357234</span>, <span class="fl">0.370462</span>, <span class="fl">0.370462</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span>, <span class="st">"method"</span> <span class="op">=</span> <span class="va">c</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, group <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">method</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Iteration"</span>, y <span class="op">=</span> <span class="st">"Second Parameter Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Second Parameter Value Convergence"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ggplot2 wasn't detected. Please install to see the plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Grad_Hess_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">239.962</span>, <span class="fl">234.592</span>, <span class="fl">234.454</span>, <span class="fl">234.362</span>, <span class="fl">234.282</span>, <span class="fl">234.226</span>, <span class="fl">234.178</span>, <span class="fl">234.144</span>, <span class="fl">234.116</span>, <span class="fl">234.094</span>, <span class="fl">234.076</span>, <span class="fl">234.062</span>, <span class="fl">234.052</span>, <span class="fl">234.044</span>, <span class="fl">234.038</span>, <span class="fl">234.032</span>, <span class="fl">234.028</span>, <span class="fl">234.026</span>, <span class="fl">234.022</span>, <span class="fl">234.02</span>, <span class="fl">234.02</span>, <span class="fl">234.018</span>, <span class="fl">234.018</span>, <span class="fl">239.962</span>, <span class="fl">234.592</span>, <span class="fl">234.454</span>, <span class="fl">234.494</span>, <span class="fl">234.362</span>, <span class="fl">234.416</span>, <span class="fl">234.284</span>, <span class="fl">234.344</span>, <span class="fl">234.226</span>, <span class="fl">234.292</span>, <span class="fl">234.174</span>, <span class="fl">234.244</span>, <span class="fl">234.142</span>, <span class="fl">234.204</span>, <span class="fl">234.112</span>, <span class="fl">234.17</span>, <span class="fl">234.092</span>, <span class="fl">234.144</span>, <span class="fl">234.072</span>, <span class="fl">234.122</span>, <span class="fl">234.06</span>, <span class="fl">234.102</span>, <span class="fl">234.102</span>, <span class="fl">239.962</span>, <span class="fl">239.438</span>, <span class="fl">238.74</span>, <span class="fl">238.104</span>, <span class="fl">237.536</span>, <span class="fl">237.036</span>, <span class="fl">236.598</span>, <span class="fl">236.22</span>, <span class="fl">235.89</span>, <span class="fl">235.608</span>, <span class="fl">235.364</span>, <span class="fl">235.156</span>, <span class="fl">234.978</span>, <span class="fl">234.826</span>, <span class="fl">234.696</span>, <span class="fl">234.586</span>, <span class="fl">234.492</span>, <span class="fl">234.414</span>, <span class="fl">234.348</span>, <span class="fl">234.292</span>, <span class="fl">234.244</span>, <span class="fl">234.206</span>, <span class="fl">234.206</span>, <span class="fl">239.962</span>, <span class="fl">237.064</span>, <span class="fl">235.166</span>, <span class="fl">234.276</span>, <span class="fl">234.118</span>, <span class="fl">234.34</span>, <span class="fl">234.642</span>, <span class="fl">234.804</span>, <span class="fl">234.766</span>, <span class="fl">234.58</span>, <span class="fl">234.334</span>, <span class="fl">234.122</span>, <span class="fl">234.018</span>, <span class="fl">234.042</span>, <span class="fl">234.142</span>, <span class="fl">234.246</span>, <span class="fl">234.298</span>, <span class="fl">234.286</span>, <span class="fl">234.23</span>, <span class="fl">234.158</span>, <span class="fl">234.09</span>, <span class="fl">234.04</span>, <span class="fl">234.04</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"standard"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"momentum"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adadelta"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span>, <span class="st">"adam"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span>, <span class="st">"method"</span> <span class="op">=</span> <span class="va">c</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, group <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">method</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Iteration"</span>, y <span class="op">=</span> <span class="st">"Log-Likelihood Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Log-Likelihood Convergence"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ggplot2 wasn't detected. Please install to see the plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Grad_Hess_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="672"></p>
<div class="section level3">
<h3 id="hyper-parameter-tuning-examples">Hyper-parameter Tuning Examples<a class="anchor" aria-label="anchor" href="#hyper-parameter-tuning-examples"></a>
</h3>
<p>First, a brief comparison of learning rates with the standard
gradient descent method. For this analysis, the gradient was on the
scale of (-2,2) so a learning rate on the scale of ~ 1/10 was
appropriate. If the gradient were much larger then the learning rate
would need to be correspondingly decreased. If the learning rate is too
high, then the estimate will be unstable and oscillate. If the learning
rate is too low then the estimate will not converge in a reasonable
amount of time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.0758866</span>, <span class="op">-</span><span class="fl">0.0524678</span>, <span class="op">-</span><span class="fl">0.0297801</span>, <span class="op">-</span><span class="fl">0.00784991</span>, <span class="fl">0.0133049</span>, <span class="fl">0.0336744</span>, <span class="fl">0.053255</span>, <span class="fl">0.0720488</span>, <span class="fl">0.0900628</span>, <span class="fl">0.107308</span>, <span class="fl">0.123797</span>, <span class="fl">0.139549</span>, <span class="fl">0.154581</span>, <span class="fl">0.168914</span>, <span class="fl">0.18257</span>, <span class="fl">0.195571</span>, <span class="fl">0.207941</span>, <span class="fl">0.219702</span>, <span class="fl">0.230879</span>, <span class="fl">0.241495</span>, <span class="fl">0.251573</span>, <span class="fl">0.251573</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.141134</span>, <span class="fl">0.305602</span>, <span class="fl">0.376672</span>, <span class="fl">0.406159</span>, <span class="fl">0.418355</span>, <span class="fl">0.423402</span>, <span class="fl">0.425492</span>, <span class="fl">0.426358</span>, <span class="fl">0.426717</span>, <span class="fl">0.426865</span>, <span class="fl">0.426927</span>, <span class="fl">0.426952</span>, <span class="fl">0.426963</span>, <span class="fl">0.426967</span>, <span class="fl">0.426969</span>, <span class="fl">0.42697</span>, <span class="fl">0.42697</span>, <span class="fl">0.42697</span>, <span class="fl">0.42697</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.382267</span>, <span class="fl">0.481728</span>, <span class="fl">0.371577</span>, <span class="fl">0.474396</span>, <span class="fl">0.383262</span>, <span class="fl">0.464408</span>, <span class="fl">0.392812</span>, <span class="fl">0.456452</span>, <span class="fl">0.40023</span>, <span class="fl">0.45019</span>, <span class="fl">0.406007</span>, <span class="fl">0.445259</span>, <span class="fl">0.41052</span>, <span class="fl">0.441374</span>, <span class="fl">0.414052</span>, <span class="fl">0.438314</span>, <span class="fl">0.416821</span>, <span class="fl">0.435902</span>, <span class="fl">0.418993</span>, <span class="fl">0.434002</span>, <span class="fl">0.420699</span>, <span class="fl">0.420699</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.01"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.1"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span>, <span class="st">"LearningRate"</span> <span class="op">=</span> <span class="va">c</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, group <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">LearningRate</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">LearningRate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Iteration"</span>, y <span class="op">=</span> <span class="st">"Second Parameter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Second Parameter Convergence"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ggplot2 wasn't detected. Please install to see the plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Grad_Hess_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="672"></p>
<p>Next, the momentum decay. The momentum decay term is helpful
particularly when the standard method overshoots the solution. In this
example, the standard method at a learning rate of 0.1 has no issue
overshooting the solution, so the momentum method was tested at a
learning rate of 0.2 to induce oscillation. At a learning rate of 0.0,
we have the standard gradient descent and as we increase the momentum
effect we see faster convergence.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.382267</span>, <span class="fl">0.481728</span>, <span class="fl">0.371577</span>, <span class="fl">0.474396</span>, <span class="fl">0.383262</span>, <span class="fl">0.464408</span>, <span class="fl">0.392812</span>, <span class="fl">0.456452</span>, <span class="fl">0.40023</span>, <span class="fl">0.45019</span>, <span class="fl">0.406007</span>, <span class="fl">0.445259</span>, <span class="fl">0.41052</span>, <span class="fl">0.441374</span>, <span class="fl">0.414052</span>, <span class="fl">0.438314</span>, <span class="fl">0.416821</span>, <span class="fl">0.435902</span>, <span class="fl">0.418993</span>, <span class="fl">0.434002</span>, <span class="fl">0.420699</span>, <span class="fl">0.420699</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.382267</span>, <span class="fl">0.481728</span>, <span class="fl">0.391469</span>, <span class="fl">0.435244</span>, <span class="fl">0.429155</span>, <span class="fl">0.424804</span>, <span class="fl">0.427892</span>, <span class="fl">0.426568</span>, <span class="fl">0.427082</span>, <span class="fl">0.427015</span>, <span class="fl">0.426915</span>, <span class="fl">0.426992</span>, <span class="fl">0.426967</span>, <span class="fl">0.42697</span>, <span class="fl">0.426971</span>, <span class="fl">0.42697</span>, <span class="fl">0.426971</span>, <span class="fl">0.42697</span>, <span class="fl">0.42697</span>, <span class="fl">0.426971</span>, <span class="fl">0.426971</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.382267</span>, <span class="fl">0.481728</span>, <span class="fl">0.421307</span>, <span class="fl">0.389624</span>, <span class="fl">0.442182</span>, <span class="fl">0.445048</span>, <span class="fl">0.414796</span>, <span class="fl">0.420771</span>, <span class="fl">0.433596</span>, <span class="fl">0.427802</span>, <span class="fl">0.424361</span>, <span class="fl">0.427741</span>, <span class="fl">0.42752</span>, <span class="fl">0.426131</span>, <span class="fl">0.427168</span>, <span class="fl">0.427483</span>, <span class="fl">0.426655</span>, <span class="fl">0.426746</span>, <span class="fl">0.427195</span>, <span class="fl">0.427034</span>, <span class="fl">0.426856</span>, <span class="fl">0.426856</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.0"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.2"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span>, <span class="st">"0.5"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span>, <span class="st">"MomentumDecay"</span> <span class="op">=</span> <span class="va">c</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, group <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">MomentumDecay</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">MomentumDecay</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Iteration"</span>, y <span class="op">=</span> <span class="st">"Second Parameter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Second Parameter Convergence"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ggplot2 wasn't detected. Please install to see the plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Grad_Hess_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="672"></p>
<p>Finally, we have the epsilon offset used in the adadelta method. In
this example, if the offset is too low the change in parameter value per
iteration is near zero, then as it is increased the algorithm converges
faster until the estimate oscillates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.0998946</span>, <span class="op">-</span><span class="fl">0.0997455</span>, <span class="op">-</span><span class="fl">0.0995686</span>, <span class="op">-</span><span class="fl">0.0993678</span>, <span class="op">-</span><span class="fl">0.0991457</span>, <span class="op">-</span><span class="fl">0.0989042</span>, <span class="op">-</span><span class="fl">0.0986448</span>, <span class="op">-</span><span class="fl">0.0983686</span>, <span class="op">-</span><span class="fl">0.0980766</span>, <span class="op">-</span><span class="fl">0.0977695</span>, <span class="op">-</span><span class="fl">0.0974482</span>, <span class="op">-</span><span class="fl">0.0971132</span>, <span class="op">-</span><span class="fl">0.096765</span>, <span class="op">-</span><span class="fl">0.0964041</span>, <span class="op">-</span><span class="fl">0.0960311</span>, <span class="op">-</span><span class="fl">0.0956462</span>, <span class="op">-</span><span class="fl">0.0952498</span>, <span class="op">-</span><span class="fl">0.0948422</span>, <span class="op">-</span><span class="fl">0.0944238</span>, <span class="op">-</span><span class="fl">0.0939948</span>, <span class="op">-</span><span class="fl">0.0935554</span>, <span class="op">-</span><span class="fl">0.0935554</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.0894592</span>, <span class="op">-</span><span class="fl">0.0745523</span>, <span class="op">-</span><span class="fl">0.0569106</span>, <span class="op">-</span><span class="fl">0.0369613</span>, <span class="op">-</span><span class="fl">0.0149815</span>, <span class="fl">0.00881833</span>, <span class="fl">0.0342662</span>, <span class="fl">0.0612136</span>, <span class="fl">0.0895258</span>, <span class="fl">0.119075</span>, <span class="fl">0.149732</span>, <span class="fl">0.181361</span>, <span class="fl">0.213808</span>, <span class="fl">0.246885</span>, <span class="fl">0.280336</span>, <span class="fl">0.313768</span>, <span class="fl">0.346445</span>, <span class="fl">0.376444</span>, <span class="fl">0.393247</span>, <span class="fl">0.380437</span>, <span class="fl">0.397974</span>, <span class="fl">0.397974</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.0666699</span>, <span class="op">-</span><span class="fl">0.0195369</span>, <span class="fl">0.0357806</span>, <span class="fl">0.0976085</span>, <span class="fl">0.164622</span>, <span class="fl">0.235362</span>, <span class="fl">0.307561</span>, <span class="fl">0.375392</span>, <span class="fl">0.39949</span>, <span class="fl">0.393904</span>, <span class="fl">0.42769</span>, <span class="fl">0.416127</span>, <span class="fl">0.448594</span>, <span class="fl">0.412644</span>, <span class="fl">0.445826</span>, <span class="fl">0.410436</span>, <span class="fl">0.445034</span>, <span class="fl">0.409797</span>, <span class="fl">0.444717</span>, <span class="fl">0.409586</span>, <span class="fl">0.444599</span>, <span class="fl">0.444599</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.00530869</span>, <span class="fl">0.154075</span>, <span class="fl">0.317511</span>, <span class="fl">0.438734</span>, <span class="fl">0.311745</span>, <span class="fl">0.479287</span>, <span class="fl">0.359676</span>, <span class="fl">0.509816</span>, <span class="fl">0.380595</span>, <span class="fl">0.519051</span>, <span class="fl">0.390015</span>, <span class="fl">0.516403</span>, <span class="fl">0.39013</span>, <span class="fl">0.51552</span>, <span class="fl">0.389794</span>, <span class="fl">0.484692</span>, <span class="fl">0.374198</span>, <span class="fl">0.483729</span>, <span class="fl">0.372471</span>, <span class="fl">0.483021</span>, <span class="fl">0.372011</span>, <span class="fl">0.372011</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-8"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-4"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-3"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span>, <span class="st">"1e-2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="va">x</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">y</span>, <span class="st">"Epsilon"</span> <span class="op">=</span> <span class="va">c</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, group <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">Epsilon</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">Epsilon</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="st">"linewidth"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Iteration"</span>, y <span class="op">=</span> <span class="st">"Second Parameter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Second Parameter Convergence"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"ggplot2 wasn't detected. Please install to see the plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="Grad_Hess_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="672"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
