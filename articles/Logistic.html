<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Logistic Regression • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logistic Regression">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Equation_Expression.html">Unified Equation Representation</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Logistic.html">Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Matched_Case_Control.html">Matched Case-Control Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Logistic Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/Logistic.Rmd" class="external-link"><code>vignettes/Logistic.Rmd</code></a></small>
      <div class="d-none name"><code>Logistic.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: From versions 1.3.1 to 1.4.1 the expected inputs changed. Regressions are now run with CoxRun and PoisRun and formula inputs. Please see the 'Unified Equation Representation' vignette for more details.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:data.table':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     between, first, last</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div class="section level2">
<h2 id="logistic-modeling-for-binomial-odds-and-binary-data">Logistic Modeling for Binomial Odds and Binary Data<a class="anchor" aria-label="anchor" href="#logistic-modeling-for-binomial-odds-and-binary-data"></a>
</h2>
<p>One alternative regression method in Colossus for predicting the
probability of an event in independent trials is logistic regression.
The theory is presented in the following section.</p>
<div class="section level3">
<h3 id="general-theory">General Theory<a class="anchor" aria-label="anchor" href="#general-theory"></a>
</h3>
<p>We start by describing the structure of the data. The logistic
regression models in Colossus assume the data can be represented in
terms of trials, events, and risk factors. Similar to a Poisson model
using person-years and number of events in each row, a logistic model
requires some measure of the number of independent trials and events for
each group. A special case is an analysis in which each row represents
one trial, and either 0 or 1 events are observed. The likelihood
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>)
for a logistic model is a function of the trials
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mi>i</mi></msub><annotation encoding="application/x-tex">N_i</annotation></semantics></math>),
events
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>),
and the probability of a success
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>)
for each row,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
In Colossus, the log-likelihood
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">Ll</annotation></semantics></math>)
is optimized.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>L</mi><mo>=</mo><munder><mo>∏</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>p</mi><mi>i</mi><msub><mi>y</mi><mi>i</mi></msub></msubsup><mo>×</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>N</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>L</mi><mi>l</mi><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    L = \prod_i \left [ p_i^{y_i} \times (1-p_i)^{N_i - y_i} \right ] \\
    Ll = \sum_i \left [ y_i \ln(p_i) + (N_i - y_i) \ln(1-p_i) \right ] \\
\end{aligned}
</annotation></semantics></math></p>
<p>Similar to other survival models in Colossus, a model is written as a
function of the various risk factors
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>,</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(\vec{\beta}, \vec{x})</annotation></semantics></math>).
This function is related to the probability through a linking function.
Three options are currently available: odds, identity, and complementary
log linking, based on the options present in 32-bit Epicure.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>p</mi><mrow><mi>o</mi><mi>d</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>,</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>,</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>p</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>,</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>p</mi><mrow><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>,</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    p_{odds} = \frac{f(\vec{\beta}, \vec{x})}{1+f(\vec{\beta}, \vec{x})} \\
    p_{id} = f(\vec{\beta}, \vec{x}) \\
    p_{comp} = e^{-f(\vec{\beta}, \vec{x})}
\end{aligned}
</annotation></semantics></math></p>
<p>Similar to other regression models in Colossus, the first derivative
vector and second derivative matrix are calculated to optimize the model
parameters.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>∂</mi><mi>L</mi><mi>l</mi></mrow><mrow><mi>∂</mi><mi>μ</mi></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><mfrac><mrow><mi>∂</mi><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>μ</mi></mrow><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mi>∂</mi><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>μ</mi></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mi>L</mi><mi>l</mi></mrow><mrow><mi>∂</mi><mi>μ</mi><mi>∂</mi><mi>ν</mi></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>μ</mi><mi>∂</mi><mi>ν</mi></mrow><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo>−</mo><mfrac><mrow><mi>∂</mi><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>μ</mi></mrow><msub><mi>p</mi><mi>i</mi></msub></mfrac><mfrac><mrow><mi>∂</mi><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>ν</mi></mrow><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>μ</mi><mi>∂</mi><mi>ν</mi></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>∂</mi><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>μ</mi></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mfrac><mrow><mi>∂</mi><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mi>∂</mi><mi>ν</mi></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \frac{\partial Ll}{\partial \mu} = \sum_i \left [ y_i \frac{\partial p_i/\partial \mu}{p_i} - (N_i - y_i) \frac{\partial p_i/\partial \mu}{1-p_i} \right ] \\
    \frac{\partial^2 Ll}{\partial \mu \partial \nu} = \sum_i \left [ y_i \left (\frac{\partial^2 p_i/\partial \mu \partial \nu}{p_i} - \frac{\partial p_i/\partial \mu}{p_i} \frac{\partial p_i/\partial \nu}{p_i} \right ) - (N_i - y_i) \left ( \frac{\partial^2 p_i/\partial \mu \partial \nu}{1-p_i} + \frac{\partial p_i/\partial \mu}{1-p_i} \frac{\partial p_i/\partial \nu}{1-p_i} \right ) \right ] \\
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="examples-of-use">Examples of Use<a class="anchor" aria-label="anchor" href="#examples-of-use"></a>
</h3>
<p>The use of a logistic model in Colossus closely follows the other
regression options. We start by loading and preparing the data. In this
example, we will be using the Veterans’ Administration Lung Cancer study
data from the survival package. Every row has 1 trial and a binary event
status column. Once again, our model uses a trial column, an event
column, and the “risk” equation that will be converted to a probability.
In this case, the number of trials is 1, so the column can be omitted,
but to illustrate, we will artificially create a trial column named
“trial”.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="va">veteran</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">veteran</span><span class="op">)</span></span>
<span><span class="co"># Make the same adjustments as Epicure example 6.5</span></span>
<span><span class="va">karno</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">karno</span></span>
<span><span class="va">karno</span><span class="op">[</span><span class="fl">93</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">karno</span> <span class="op">&lt;-</span> <span class="va">karno</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">trt</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">trt</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">cell_string</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">celltype</span></span>
<span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>  <span class="va">cell_string</span> <span class="op">==</span> <span class="st">"squamous"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">cell_string</span> <span class="op">==</span> <span class="st">"smallcell"</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>  <span class="va">cell_string</span> <span class="op">==</span> <span class="st">"adeno"</span> <span class="op">~</span> <span class="fl">3</span>,</span>
<span>  <span class="va">cell_string</span> <span class="op">==</span> <span class="st">"large"</span> <span class="op">~</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="va">cell</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">karno50</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">karno</span> <span class="op">-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div>
<p>We will start with testing the effects of cell type. By default,
Colossus will always remove the first level of a factored column. We can
force Colossus to include every level by defining the lowest level to an
unused value, -1 in this case. This gives the same final model as if we
removed the baseline and added an intercept column (CONST). In this
case, the p-values are for the null hypothesis that the cell type has no
effect. If we removed the baseline and added an intercept, the p-values
would be for the null hypothesis that the cell type has no effect above
the baseline.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">cell</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">Logit</span><span class="op">(</span><span class="va">trial</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="fu">loglinear</span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">Logit</span><span class="op">(</span><span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="fu">loglinear</span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">0</span>, ncores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogisticRun.html">LogisticRun</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate Subterm Term Number Central Estimate Standard Error 2-tail p-value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;          &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    cell_0  loglin           0         3.258061      1.0190324   1.387638e-03</span></span>
<span><span class="co">#&gt; 2:    cell_1  loglin           0         2.047690      0.5312790   1.160781e-04</span></span>
<span><span class="co">#&gt; 3:    cell_2  loglin           0         2.708038      0.5962816   5.584424e-06</span></span>
<span><span class="co">#&gt; 4:    cell_3  loglin           0         3.258061      1.0190324   1.387638e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logisitic Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 64.43,  Deviation: 64.43,  AIC: 72.43,  BIC: 84.11</span></span>
<span><span class="co">#&gt; Iterations run: 11</span></span>
<span><span class="co">#&gt; maximum step size: 1.07e-04, maximum first derivative: 3.45e-05</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in 0.02 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
<p>In this analysis, we were using the default of the odds ratio. The
linking function can be changed by using the “link” option. The
following examples show the impact of using each linking function. Note
that the probability must be between 0-1, so the starting values are set
to ensure that the initial probability estimates are valid. Because we
are using categorical risk factors, every model converges to the same
score and event probabilities; however, the standard error and p-values
are affected. If we were using continuous variables, the linking
functions would give a way to define further complicated risk
models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogisticRun.html">LogisticRun</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df</span>, control <span class="op">=</span> <span class="va">control</span>, a_n <span class="op">=</span> <span class="va">a_n</span>, link <span class="op">=</span> <span class="st">"odds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate Subterm Term Number Central Estimate Standard Error 2-tail p-value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;          &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    cell_0  loglin           0         3.258065      1.0190343   1.387648e-03</span></span>
<span><span class="co">#&gt; 2:    cell_1  loglin           0         2.047690      0.5312791   1.160781e-04</span></span>
<span><span class="co">#&gt; 3:    cell_2  loglin           0         2.708039      0.5962820   5.584436e-06</span></span>
<span><span class="co">#&gt; 4:    cell_3  loglin           0         3.258065      1.0190343   1.387648e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logisitic Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 64.43,  Deviation: 64.43,  AIC: 72.43,  BIC: 84.11</span></span>
<span><span class="co">#&gt; Iterations run: 11</span></span>
<span><span class="co">#&gt; maximum step size: 9.57e-05, maximum first derivative: 3.07e-05</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in 0.01 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogisticRun.html">LogisticRun</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df</span>, control <span class="op">=</span> <span class="va">control</span>, a_n <span class="op">=</span> <span class="va">a_n</span>, link <span class="op">=</span> <span class="st">"ident"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate Subterm Term Number Central Estimate Standard Error 2-tail p-value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;          &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    cell_0  loglin           0      -0.03772402     0.03773426     0.31744183</span></span>
<span><span class="co">#&gt; 2:    cell_1  loglin           0      -0.12136126     0.06071778     0.04563257</span></span>
<span><span class="co">#&gt; 3:    cell_2  loglin           0      -0.06453783     0.03726759     0.08331963</span></span>
<span><span class="co">#&gt; 4:    cell_3  loglin           0      -0.03772402     0.03773426     0.31744183</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logisitic Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 64.43,  Deviation: 64.43,  AIC: 72.43,  BIC: 84.11</span></span>
<span><span class="co">#&gt; Iterations run: 11</span></span>
<span><span class="co">#&gt; maximum step size: 4.86e-05, maximum first derivative: 1.15e-02</span></span>
<span><span class="co">#&gt; Analysis did not converge, check convergence criteria or run further</span></span>
<span><span class="co">#&gt; Run finished in 0.01 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogisticRun.html">LogisticRun</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df</span>, control <span class="op">=</span> <span class="va">control</span>, a_n <span class="op">=</span> <span class="va">a_n</span>, link <span class="op">=</span> <span class="st">"loglink"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate Subterm Term Number Central Estimate Standard Error 2-tail p-value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;          &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    cell_0  loglin           0        -3.276984      1.0000387   1.049695e-03</span></span>
<span><span class="co">#&gt; 2:    cell_1  loglin           0        -2.108983      0.5003059   2.493510e-05</span></span>
<span><span class="co">#&gt; 3:    cell_2  loglin           0        -2.740478      0.5774463   2.076244e-06</span></span>
<span><span class="co">#&gt; 4:    cell_3  loglin           0        -3.276984      1.0000387   1.049695e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logisitic Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 64.43,  Deviation: 64.43,  AIC: 72.43,  BIC: 84.11</span></span>
<span><span class="co">#&gt; Iterations run: 12</span></span>
<span><span class="co">#&gt; maximum step size: 1.26e-04, maximum first derivative: 4.51e-05</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in 0.01 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
