<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Colossus Description • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Colossus Description">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Equation_Expression.html">Unified Equation Representation</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Logistic.html">Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Matched_Case_Control.html">Matched Case-Control Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Colossus Description</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/Starting-Description.Rmd" class="external-link"><code>vignettes/Starting-Description.Rmd</code></a></small>
      <div class="d-none name"><code>Starting-Description.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"OMP_THREAD_LIMIT"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Reducing core use, to avoid accidental use of too many cores</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="colossus-description">Colossus Description<a class="anchor" aria-label="anchor" href="#colossus-description"></a>
</h2>
</div>
<div class="section level2">
<h2 id="model-structure">Model Structure<a class="anchor" aria-label="anchor" href="#model-structure"></a>
</h2>
<p>At its full potential, Colossus can analyze a vast number of possible
risk/rate models. Specifically, Colossus is designed to allow for a
combination of linear and non-linear models to estimate Cox proportional
hazard ratios, Poisson model rates, and Fine-Gray Competing risk ratios.
The simplest of which is an exponential model. The simplest model
generally used for hazard ratios in survival analysis is the exponential
of a linear function of covariates.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>,</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>β</mi><mo accent="true">→</mo></mover><mo>⋅</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    R(\vec{\beta},\vec{x})=\exp(\vec{\beta} \cdot \vec{x})
\end{aligned}
</annotation></semantics></math></p>
<p>In Colossus, this general model is extended by abstracting to the sum
and product of terms and subterms. In this vignette, the value
calculated to quantify the risk of an event will be denoted as the risk,
R, however the exact meaning differs. In Cox proportional hazard
modeling, the risk calculated is a hazard ratio. In Poisson modeling the
risk calculated is an estimated number of events per person-year. The
risk
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>)
has a set formula dependent on terms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>).
Each term has a formula dependent on the product of subterms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>).
Each subterm is a function of a covariates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>)
and parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha,\beta</annotation></semantics></math>).</p>
<p>There are currently five types of risk models available. The risk can
be expressed as an additive model
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>A</mi></msub><annotation encoding="application/x-tex">R_A</annotation></semantics></math>),
product additive model
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>P</mi><mi>A</mi></mrow></msub><annotation encoding="application/x-tex">R_{PA}</annotation></semantics></math>),
Product additive excess model
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>P</mi><mi>A</mi><mi>E</mi></mrow></msub><annotation encoding="application/x-tex">R_{PAE}</annotation></semantics></math>),
multiplicative relative model
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>M</mi></msub><annotation encoding="application/x-tex">R_M</annotation></semantics></math>),
multiplicative excess model
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>M</mi><mi>E</mi></mrow></msub><annotation encoding="application/x-tex">R_{ME}</annotation></semantics></math>),
or the geometric mixture model with relative risks or excess risks
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>G</mi><mi>M</mi><mi>I</mi><mi>X</mi></mrow></msub><annotation encoding="application/x-tex">R_{GMIX}</annotation></semantics></math>).</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mi>A</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>T</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mrow><mi>P</mi><mi>A</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>×</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>T</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mrow><mi>P</mi><mi>A</mi><mi>E</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mi>M</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>×</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mrow><mi>M</mi><mi>E</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>×</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mrow><mi>G</mi><mi>M</mi><mi>I</mi><mi>X</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>T</mi><mn>0</mn></msub><mo>×</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>T</mi><mi>i</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>θ</mi></msup><mo>×</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>T</mi><mi>i</mi><mo>*</mo></msubsup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><mi>θ</mi></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>T</mi><mi>i</mi><mo>*</mo></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>T</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Relative Risk</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>T</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Excess Risk</mtext></mtd></mtr></mtable></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    R_{A} &amp;= \sum_{i=0}^n T_i\\
    R_{PA} &amp;= T_0 \times \sum_{i=1}^n T_i\\
    R_{PAE} &amp;= T_0 \times (1 + \sum_{i=1}^n T_i)\\
    R_{M} &amp;= T_0 \times \prod_{i=1}^n(T_i)\\
    R_{ME} &amp;= T_0 \times \prod_{i=1}^n( 1 + T_i)\\
    R_{GMIX} &amp;= T_0 \times \left(\prod_{i=1}^n(T^{*}_i) \right) ^ \theta \times \left( 1 + \sum_{i=1}^n (T^{*}_i - 1) \right)^{1-\theta}\\
    T^{*}_i &amp;= \begin{cases} T_i &amp;\text{Relative Risk} \\ T_i+1 &amp;\text{Excess Risk} \end{cases}\\
\end{aligned}
</annotation></semantics></math></p>
<p>Each term is composed of a combination of 4 types of subterms. Every
covariate is part of a log-linear subterm, a linear subterm, a
product-linear subterm, or a general non-linear term. The log-linear
subterm
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>L</mi><mi>L</mi></mrow></msub><annotation encoding="application/x-tex">S_{LL}</annotation></semantics></math>)
is the exponential of a linear combination of covariates. The linear
subterm
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>L</mi></msub><annotation encoding="application/x-tex">S_L</annotation></semantics></math>)
is a linear combination of covariates. The product-linear subterm
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>P</mi><mi>L</mi></mrow></msub><annotation encoding="application/x-tex">S_{PL}</annotation></semantics></math>)
is one plus a linear combination of covariates. The general non-linear
term
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>N</mi><mi>L</mi></mrow></msub><annotation encoding="application/x-tex">S_{NL}</annotation></semantics></math>)
is the sum of exponential terms, quadratic terms, linear-threshold terms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>L</mi><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{LT}</annotation></semantics></math>),
step function terms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mi>T</mi><mi>P</mi></mrow></msub><annotation encoding="application/x-tex">F_{STP}</annotation></semantics></math>),
linear-quadratic terms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>L</mi><mi>Q</mi></mrow></msub><annotation encoding="application/x-tex">F_{LQ}</annotation></semantics></math>),
and linear-exponential terms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>L</mi><mi>E</mi><mi>X</mi><mi>P</mi></mrow></msub><annotation encoding="application/x-tex">F_{LEXP}</annotation></semantics></math>).
Each term is the product of the non-empty subterms.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>S</mi><mrow><mi>L</mi><mi>L</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∏</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>S</mi><mi>L</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>S</mi><mrow><mi>P</mi><mi>L</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>+</mo><mo>∑</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>S</mi><mrow><mi>N</mi><mi>L</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>i</mi></msub><mo>×</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>i</mi></msub><mo>⋅</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>F</mi><mrow><mi>L</mi><mi>T</mi></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>F</mi><mrow><mi>S</mi><mi>T</mi><mi>P</mi></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>F</mi><mrow><mi>L</mi><mi>Q</mi></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>F</mi><mrow><mi>L</mi><mi>E</mi><mi>X</mi><mi>P</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>F</mi><mrow><mi>L</mi><mi>T</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>i</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>&gt;</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">else</mtext></mtd></mtr></mtable></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>F</mi><mrow><mi>S</mi><mi>T</mi><mi>P</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>&gt;</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">else</mtext></mtd></mtr></mtable></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>F</mi><mrow><mi>L</mi><mi>Q</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mi>i</mi></msub><mo>⋅</mo><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>&gt;</mo><msub><mi>α</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>λ</mi><mi>i</mi></msub><mo>⋅</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msub><mi>ν</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">else</mtext></mtd></mtr></mtable></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>F</mi><mrow><mi>L</mi><mi>E</mi><mi>X</mi><mi>P</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mi>i</mi></msub><mo>⋅</mo><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>&gt;</mo><msub><mi>α</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>λ</mi><mi>i</mi></msub><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>i</mi></msub><mo>+</mo><mi>μ</mi><mo>⋅</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">else</mtext></mtd></mtr></mtable></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>T</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>S</mi><mrow><mi>L</mi><mi>L</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>×</mo><msub><mi>S</mi><mrow><mi>L</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>×</mo><msub><mi>S</mi><mrow><mi>P</mi><mi>L</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>×</mo><msub><mi>S</mi><mrow><mi>N</mi><mi>L</mi><mo>,</mo><mi>j</mi></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    S_{LL}&amp;=\prod_{i} (\exp{(x_i \cdot \beta_i)})\\
    S_{L}&amp;=\sum_i (x_i \cdot \beta_i)\\
    S_{PL}&amp;=1+ \sum (x_i \cdot \beta_i)\\
    S_{NL}&amp;=\sum_i (\alpha_i \times \exp(x_i \cdot \beta_i)) + \sum_i (\beta_i \cdot (x_i)^2)\\
    &amp; + \sum_i F_{LT} + \sum_i F_{STP} + \sum_i F_{LQ} + \sum_i F_{LEXP}\\
    F_{LT} &amp;= \begin{cases} \alpha_i \cdot (x-\beta_i) &amp; (x&gt;\beta_i) \\ 0 &amp;\text{else} \end{cases}\\
    F_{STP} &amp;= \begin{cases} \alpha_i &amp; (x&gt;\beta_i) \\ 0 &amp;\text{else} \end{cases}\\
    F_{LQ} &amp;= \begin{cases} \beta_i \cdot x &amp; (x&gt;\alpha_i) \\ \lambda_i \cdot x^2 + \nu_i &amp;\text{else} \end{cases}\\
    F_{LEXP} &amp;= \begin{cases} \beta_i \cdot x &amp; (x&gt;\alpha_i) \\ \lambda_i - \exp{(\nu_i + \mu \cdot x)} &amp;\text{else} \end{cases}\\
    T_j&amp;=S_{LL,j} \times S_{L,j} \times S_{PL,j} \times S_{NL,j}
\end{aligned}
</annotation></semantics></math></p>
<p>In short, every element of the risk model has a subterm type, term
number, covariate, and parameter value.</p>
</div>
<div class="section level2">
<h2 id="using-the-standard-model">Using The Standard Model<a class="anchor" aria-label="anchor" href="#using-the-standard-model"></a>
</h2>
<p>In Colossus, every equation is defined in a very similar fashion.
Elements of the risk equation can be viewed as rows of a table: the
columns store covariate names, term numbers, subterms types, and a
starting point. For more complex regression most parameters can also be
set to remain constant over the regression. Doing so forces the
parameter value to be constant but not remove the element from the risk
calculations. Constant elements are used for risk calculation but are
not used for calculating steps or standard deviations. For a
multiplicative excess risk model, the following table and equation are
equivalent.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Term number</th>
<th align="center">subterm type</th>
<th align="center">covariate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">LogLinear</td>
<td align="center">a</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">Linear</td>
<td align="center">b</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">Linear</td>
<td align="center">c</td>
</tr>
</tbody>
</table>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msub><mi>β</mi><mi>b</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>b</mi></msub><mo>+</mo><msub><mi>β</mi><mi>c</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    R = \exp{(\beta_{a} \cdot x_{a})} \times (1+\beta_{b} \cdot x_{b} + \beta_{c} \cdot x_{c})
\end{aligned}
</annotation></semantics></math></p>
<p>If the user wanted to update the model to include a new term with a
product-linear subterm, then the table would only need to be updated
with a new row.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Term number</th>
<th align="center">subterm type</th>
<th align="center">covariate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">LogLinear</td>
<td align="center">a</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">Linear</td>
<td align="center">b</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">Linear</td>
<td align="center">c</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">Product-Linear</td>
<td align="center">d</td>
</tr>
</tbody>
</table>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>b</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>b</mi></msub><mo>+</mo><msub><mi>β</mi><mi>c</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>+</mo><msub><mi>β</mi><mi>d</mi></msub><mo>⋅</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    R = \exp{(\beta_{a} \cdot x_{a})} \times (1 + (\beta_{b} \cdot x_{b} + \beta_{c} \cdot x_{c})) \times (2 + \beta_{d} \cdot x_{d})
\end{aligned}
</annotation></semantics></math></p>
<p>Note that the multiplicative excess model is taking the product of
terms, each of which is the product of subterms. The same equation may
be written with subterms distributed over different terms in the
multiplicative model without changing the final value. The only
exception is subterms moved from or into the “first” term in the
multiplicative excess model. The same equation could be expressed in
ways with different computational complexity.</p>
<p>Models in Colossus are passed in the form of a formula. Each subterm
of the model is expressed as an element of the formula. The model
identifiers (A, M, PA, PAE, GMIX) are included at the end of the
formula. Every model except the additive and multiplicative models have
a distinction between the first and remaining terms. Colossus defaults
to term 0 being the unique term.</p>
<p>The final table is also equivalent to the following code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></span>
<span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>, <span class="st">"lin"</span>, <span class="st">"lin"</span>, <span class="st">"plin"</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">outcome</span> <span class="op">~</span> <span class="fu">loglinear</span><span class="op">(</span><span class="va">a</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">linear</span><span class="op">(</span><span class="va">b</span>, <span class="va">c</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">plinear</span><span class="op">(</span><span class="va">d</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ME</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Interior colossus functions convert between the vectors and formula
representations. <em>names</em> denotes the column names used,
<em>term_n</em> denotes the term numbers, <em>tform</em> denotes the
subterm formula, <em>modelform</em> denotes the term formula, and
<em>a_n</em> denotes the initial guesses for the parameter values. All
of which are assumed to be in the same order. A function is called
before regression that reorders the inputs in order of terms, subterm
types, etc.</p>
</div>
<div class="section level2">
<h2 id="survival-time-and-event-data">Survival Time and Event Data<a class="anchor" aria-label="anchor" href="#survival-time-and-event-data"></a>
</h2>
<p>Colossus performs survival analysis via either a Cox Proportional
Hazards or a Poisson model regression. In both cases, the user specifies
which columns contain time duration and events of interest. For the
Poisson model regression, these would be which column contains the
person-years and number of events for each row of data. For the Cox
Proportional Hazards regression, the user identifies which columns
provide starting and ending times, and what column gives the event
status. The event status is assumed to be a binary covariate which is 1
for intervals containing an event. Colossus supports left-censored data,
right-censored data, and interval-censored data. The data is interval
censored by default, so left and right censoring are handled by defining
interval endpoints outside the minimum or maximum event times. For
Poisson model regression the user only provides columns for the
person-years per row and number of events. Poisson model regression
supports any non-negative number of events.</p>
<p>On the user side, the names of columns containing the time and events
need to be given. Let us assume we have a dataframe organized as
follows:</p>
<table class="table">
<thead><tr class="header">
<th align="center">UserID</th>
<th align="center">Starting_Age</th>
<th align="center">Ending_Age</th>
<th align="center">Cancer_Status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">112</td>
<td align="center">18</td>
<td align="center">30</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">114</td>
<td align="center">20</td>
<td align="center">45</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">213</td>
<td align="center">18</td>
<td align="center">57</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
</tbody>
</table>
<p>For Cox proportional hazard, we need to provide three column names:
the starting age, the ending age, and if an event happened during the
interval. In this case that would be “Starting_Age”, “Ending_Age”, and
“Cancer_Status”. In this example, we have interval data but that may not
always be the case. Colossus is designed to allow the user to omit
interval columns to represent truncation. Colossus assumes that this
means that the person has the missing endpoint outside of the available
data range and creates a dummy column to reference as the interval
endpoint. In the formula, the interval endpoints can be named “tstart”
and “tend”. So in code, these variables would look like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  <span class="st">"UserID"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">112</span>, <span class="fl">114</span>, <span class="fl">213</span>, <span class="fl">214</span>, <span class="fl">115</span>, <span class="fl">116</span>, <span class="fl">117</span><span class="op">)</span>,</span>
<span>  <span class="st">"Starting_Age"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">21</span>, <span class="fl">20</span>, <span class="fl">18</span><span class="op">)</span>,</span>
<span>  <span class="st">"Ending_Age"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">45</span>, <span class="fl">57</span>, <span class="fl">47</span>, <span class="fl">36</span>, <span class="fl">60</span>, <span class="fl">55</span><span class="op">)</span>,</span>
<span>  <span class="st">"Cancer_Status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="st">"a"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="st">"b"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="fl">2</span>, <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  <span class="st">"c"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  <span class="st">"d"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># For the interval case</span></span>
<span><span class="va">tstart</span> <span class="op">&lt;-</span> <span class="st">"Starting_Age"</span></span>
<span><span class="va">tend</span> <span class="op">&lt;-</span> <span class="st">"Ending_Age"</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"Cancer_Status"</span></span></code></pre></div>
<p>Suppose instead we were interested in a Poisson model regression, the
only difference is instead of providing interval endpoints we give a
column of interval lengths. Suppose we are now working with the
following table:</p>
<table class="table">
<thead><tr class="header">
<th align="center">UserID</th>
<th align="center">Starting_Age</th>
<th align="center">Ending_Age</th>
<th align="center">Person_Years</th>
<th align="center">Cancer_Status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">112</td>
<td align="center">18</td>
<td align="center">30</td>
<td align="center">12</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">114</td>
<td align="center">20</td>
<td align="center">45</td>
<td align="center">25</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">213</td>
<td align="center">18</td>
<td align="center">57</td>
<td align="center">39</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
</tbody>
</table>
<p>We would just provide the duration column and event column, or
“Person_Years” and “Cancer_Status”. Which in code looks like the
following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">Person_Years</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Ending_Age</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">Starting_Age</span></span>
<span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="st">"Person_Years"</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"Cancer_Status"</span></span></code></pre></div>
<p>The regression types are added to the formula on the left-hand side.
Similar to the Surv function in the survival library, the left-hand side
of the formula specifies the type of model and which time/event columns
are used.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For the interval case</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu">Cox</span><span class="op">(</span><span class="va">Starting_Age</span>, <span class="va">Ending_Age</span>, <span class="va">Cancer_Status</span><span class="op">)</span> <span class="op">~</span> <span class="va">risk_factors</span></span>
<span></span>
<span><span class="co"># Supposing we had left truncated data the following would change</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu">Cox</span><span class="op">(</span>tstart <span class="op">=</span> <span class="va">Starting_Age</span>, event <span class="op">=</span> <span class="va">Cancer_Status</span><span class="op">)</span> <span class="op">~</span> <span class="va">risk_factors</span></span>
<span></span>
<span><span class="co"># and with right truncated data the following is used</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu">Cox</span><span class="op">(</span><span class="va">Ending_Age</span>, <span class="va">Cancer_Status</span><span class="op">)</span> <span class="op">~</span> <span class="va">risk_factors</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="control-and-verbosity">Control and Verbosity<a class="anchor" aria-label="anchor" href="#control-and-verbosity"></a>
</h2>
<p>Colossus offers several options that control how the input data is
used and returned. This can be split into two general categories. The
first category is convergence parameters. These cover the number of
iterations used, limits on parameter changes, and stopping criteria. The
second category is parameters used for debugging and additional
information.</p>
<p>The common convergence parameters are as follows:</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th align="center">Parameter</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">lr</td>
<td align="center">learning rate applied to steps taken, smaller values
avoid overshooting at the risk of slower convergence. Applied to the
solution for setting the first derivative of Log-Likelihood to zero</td>
</tr>
<tr class="even">
<td align="center">maxiter</td>
<td align="center">maximum number of iterations run</td>
</tr>
<tr class="odd">
<td align="center">halfmax</td>
<td align="center">Maximum number of half-steps taken each
iteration</td>
</tr>
<tr class="even">
<td align="center">epsilon</td>
<td align="center">Minimum parameter change above convergence. If the
change is below this, the regression exits</td>
</tr>
<tr class="odd">
<td align="center">dbeta_max</td>
<td align="center">learning rate applied to limit on the steps taken.
Applied to solution to zero Log-Likelihood</td>
</tr>
<tr class="even">
<td align="center">deriv_epsilon</td>
<td align="center">Minimum Log-Likelihood first derivative above
convergence. If the largest first derivative is below this, the
regression exits</td>
</tr>
<tr class="odd">
<td align="center">step_max</td>
<td align="center">Largest starting step size. Code reduces it every
time halfmax is hit without finding an improvement. When step_max is
below epsilon, the code exits</td>
</tr>
<tr class="even">
<td align="center">verbose</td>
<td align="center">integer valued 0-4 controlling what information is
printed to the terminal. Each level includes the lower levels. 0:
silent, 1: errors printed, 2: warnings printed, 3: notes printed, 4:
debug information printed. Errors are situations that stop the
regression, warnings are situations that assume default values that the
user might not have intended, notes provide information on regression
progress, and debug prints out C++ progress and intermediate results.
The default level is 2 and True/False is converted to 3/0.</td>
</tr>
<tr class="odd">
<td align="center">ncores</td>
<td align="center">Number of physical cores assigned, cannot be greater
than the number of cores available</td>
</tr>
</tbody>
</table>
<p>The previous options are all contained within a list of parameters,
however, there are additional standalone parameters that control the
convergence. A common example is <em>keep_constant</em> which can be
used to hold parameters constant. <em>keep_constant</em> can be assigned
a vector of 0/1 for each element to denote free (0) and constant (1)
parameters.</p>
<p>Going back to our example, the code may look like the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"ncores"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"lr"</span> <span class="op">=</span> <span class="fl">0.75</span>, <span class="st">"maxiter"</span> <span class="op">=</span> <span class="fl">100</span>, <span class="st">"halfmax"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"epsilon"</span> <span class="op">=</span> <span class="fl">1e-3</span>,</span>
<span>  <span class="st">"dbeta_max"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"deriv_epsilon"</span> <span class="op">=</span> <span class="fl">1e-3</span>, <span class="st">"step_max"</span> <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  <span class="st">"verbose"</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this example, no parameters are held constant and 100 iterations
with 5 half-steps are used. There are no errors for unused control
parameters being used, they will simply be ignored. Every commonly
required control parameter has a default value which is automatically
used if not declared.</p>
</div>
<div class="section level2">
<h2 id="running-the-regression-and-output">Running the Regression and Output<a class="anchor" aria-label="anchor" href="#running-the-regression-and-output"></a>
</h2>
<p>Finally, the user calls the regression function they need. The names
used throughout this vignette are the defaults assumed. Both the Cox PH
regression and Poisson model regression are called directly and return a
list of results. Colossus contains a suite of additional checks it runs
on the inputs before starting any calculations, which are designed to
output explicit details on any issues. Printing error details may
require the verbose option to be TRUE. In code, the functions are called
as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assuming the table of covariates is stored in a data.table "df"</span></span>
<span></span>
<span><span class="va">model_cox</span> <span class="op">&lt;-</span> <span class="fu">Cox</span><span class="op">(</span><span class="va">Starting_Age</span>, <span class="va">Ending_Age</span>, <span class="va">Cancer_Status</span><span class="op">)</span> <span class="op">~</span> <span class="fu">loglinear</span><span class="op">(</span><span class="va">a</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">linear</span><span class="op">(</span><span class="va">b</span>, <span class="va">c</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plinear</span><span class="op">(</span><span class="va">d</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">multiplicative</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CoxRun.html">CoxRun</a></span><span class="op">(</span><span class="va">model_cox</span>, <span class="va">df</span>, a_n <span class="op">=</span> <span class="va">a_n</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate Subterm Term Number Central Estimate Standard Error 2-tail p-value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;          &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:         a  loglin           0             31.1        1079824          1.000</span></span>
<span><span class="co">#&gt; 2:         b     lin           1             14.4            NaN            NaN</span></span>
<span><span class="co">#&gt; 3:         c     lin           1             14.4            NaN            NaN</span></span>
<span><span class="co">#&gt; 4:         d    plin           2             31.1            477          0.948</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cox Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 1.374,  AIC: 9.374</span></span>
<span><span class="co">#&gt; Iterations run: 30</span></span>
<span><span class="co">#&gt; maximum step size: 1.000e+00, maximum first derivative: 9.764e-04</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in 0.024 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span></span>
<span><span class="co"># or a Poisson model regression</span></span>
<span><span class="va">model_pois</span> <span class="op">&lt;-</span> <span class="fu">Poisson</span><span class="op">(</span><span class="va">Person_Years</span>, <span class="va">Cancer_Status</span><span class="op">)</span>  <span class="op">~</span> <span class="fu">loglinear</span><span class="op">(</span><span class="va">a</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">linear</span><span class="op">(</span><span class="va">b</span>, <span class="va">c</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plinear</span><span class="op">(</span><span class="va">d</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">multiplicative</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PoisRun.html">PoisRun</a></span><span class="op">(</span><span class="va">model_pois</span>, <span class="va">df</span>, a_n <span class="op">=</span> <span class="va">a_n</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate Subterm Term Number Central Estimate Standard Error 2-tail p-value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt;       &lt;int&gt;            &lt;num&gt;          &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:         a  loglin           0         -0.29681        1.10226       7.88e-01</span></span>
<span><span class="co">#&gt; 2:         b     lin           1         -0.01166        0.04784       8.07e-01</span></span>
<span><span class="co">#&gt; 3:         c     lin           1          0.00725        0.00993       4.65e-01</span></span>
<span><span class="co">#&gt; 4:         d    plin           2         -0.84726        0.19126       9.42e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 11.992,  Deviation: 7.992,  AIC: 15.992,  BIC: 19.776</span></span>
<span><span class="co">#&gt; Iterations run: 5</span></span>
<span><span class="co">#&gt; maximum step size: 9.766e-04, maximum first derivative: 4.346e+02</span></span>
<span><span class="co">#&gt; Analysis did not converge, check convergence criteria or run further</span></span>
<span><span class="co">#&gt; Run finished in 0.012 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
<p>The following are output in the regression output lists:</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th align="center">Item</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">LogLik</td>
<td align="center">Final Log-Likelihood</td>
</tr>
<tr class="even">
<td align="center">First_Der</td>
<td align="center">First derivative of Log-Likelihood at the final
point</td>
</tr>
<tr class="odd">
<td align="center">Second_Der</td>
<td align="center">Matrix of second derivatives of Log-Likelihood at the
final point</td>
</tr>
<tr class="even">
<td align="center">beta_0</td>
<td align="center">The final parameter list</td>
</tr>
<tr class="odd">
<td align="center">Standard_Deviation</td>
<td align="center">Inverse-Hessian estimate of the standard
deviation</td>
</tr>
<tr class="even">
<td align="center">AIC</td>
<td align="center">Akaike information criterion for the final
solution</td>
</tr>
<tr class="odd">
<td align="center">Deviation</td>
<td align="center">Deviance calculated using the difference in
log-likelihood contributions between the saturated model and the current
model</td>
</tr>
<tr class="even">
<td align="center">Parameter_Lists</td>
<td align="center">the term numbers and term formulas used, to compare
against the expected</td>
</tr>
<tr class="odd">
<td align="center">Control_List</td>
<td align="center">a list containing the number of iterations, the
maximum step at the final iteration, and the highest first derivative
magnitude</td>
</tr>
<tr class="even">
<td align="center">Converged</td>
<td align="center">TRUE/FALSE if the regression converged</td>
</tr>
</tbody>
</table>
<p>In this case, the poisson regression did not converge. Given that the
examples were arbitrary this is not unexpected. The Poisson model
regression exited due to the step limit being below the threshold, which
means that the score was still changing significantly even at low step
sizes. To find a better solution the user would likely have to either
change the model equation or provide a new starting guess with a lower
step size limit. This is an example of how to interpret the results of a
Colossus run.</p>
<p>There are additional variants of these functions which are described
in greater detail in the other vignettes.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
