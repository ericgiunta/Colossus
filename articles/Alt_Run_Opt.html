<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Alternative Regression Options • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alternative Regression Options">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Distrib_Starts.html">Distributed Start Framework</a></li>
    <li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Alternative Regression Options</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/Alt_Run_Opt.Rmd" class="external-link"><code>vignettes/Alt_Run_Opt.Rmd</code></a></small>
      <div class="d-none name"><code>Alt_Run_Opt.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="general-options">General Options<a class="anchor" aria-label="anchor" href="#general-options"></a>
</h2>
<p>Both Cox proportional hazards and Poisson model regressions have
additional functions that can account for specific situations. There
general situations are as follows:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="27%">
<col width="27%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Option</th>
<th align="center">Description</th>
<th align="center">Cox PH</th>
<th align="center">Poisson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Stratification</td>
<td align="center">In Cox PH, the stratification is applied in the risks
groups to compare only like rows. In Poisson model regression the
stratification is an additional term in the model to account for the
effects of stratified covariates</td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
<tr class="even">
<td align="center">Simplified Model</td>
<td align="center">For a multiplicative Log-Linear model, there are
simplifications that can be made to the code. These give a faster
version.</td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Non-Derivative Calculation</td>
<td align="center">If a single iteration is needed without derivatives,
there is time and memory that can be saved</td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
<tr class="even">
<td align="center">Competing Risks</td>
<td align="center">If there is a competing event, rows are weighted by
an estimate of censoring rate to approximate a dataset without the
effect of a competing event</td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Joint Analysis</td>
<td align="center">A Poisson method which allows a model to solve for
multiple outcomes, by creating multiple copies of rows with multiple
events and using a factor variable to add covariates for specific
outcomes</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="even">
<td align="center">Distributed Initial Parameter Sets</td>
<td align="center">The user provides distribution for each starting
parameter, Colossus runs low iteration regressions at random points, and
then a full run at the best guess</td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
</tbody>
</table>
<p>The following sections review the math behind the basic functions and
how each option changes that.</p>
</div>
<div class="section level2">
<h2 id="stratification">Stratification<a class="anchor" aria-label="anchor" href="#stratification"></a>
</h2>
<div class="section level3">
<h3 id="cox-proportional-hazards">Cox Proportional Hazards<a class="anchor" aria-label="anchor" href="#cox-proportional-hazards"></a>
</h3>
<p>In Cox Proportional Hazards, the Log-Likelihood is calculated by
taking the ratio of the hazard ratio at each event to the sum of the
hazard ratios of every other row at risk. This defines the risk group
for every event time to be the intervals containing the event time.
Intervals are assumed to be open on the left and closed on the right,
and events are assumed to take place at the right end point. This gives
the following common equation for the Log-Likelihood:</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>L</mi><mi>l</mi><mo>=</mo><munderover><mo>∏</mo><mi>i</mi><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>r</mi><mi>i</mi></msub><mrow><munder><mo>∑</mo><mrow><mi>j</mi><mo>:</mo><msub><mi>t</mi><mi>j</mi></msub><mo>∈</mo><msub><mi>R</mi><mi>i</mi></msub></mrow></munder><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>δ</mi><mi>i</mi></msub></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    Ll = \prod_{i}^{n} \left( \frac{r_{i}}{\sum_{j: t_j \in R_i} r_j} \right)^{\delta_i}
\end{aligned}
</annotation></semantics></math></p>
<p>In which r denotes hazard ratios, the denominator is the sum of
hazard ratios of intervals containing the event time, and each term is
raised to the power of 1 if the interval has an event and 0 otherwise.
Different tie methods modify the denominator based on how the order of
events is assumed, but the general form still stands. The goal is to
compare each event interval to intervals within a similar time span.
Stratification adds in an additional condition. If the user stratifies
over a covariate “F” then each risk group is split into subgroups with
the same value of “F”. So the goal becomes to compare event intervals to
intervals with similar strata AND time. This is done to remove the
influence of the stratification variables from the calculations.</p>
<p>In code this is done by adding in an additional parameter for the
stratification column and using a different function to call the
regression.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Strat_Col</span> <span class="op">&lt;-</span> <span class="st">"e"</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Strata.html">RunCoxRegression_Strata</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, strat_col <span class="op">=</span> <span class="va">Strat_Col</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="poisson-regression">Poisson Regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h3>
<p>Poisson model regression does not have risk groups to account for,
but the theory is the same. To remove the influence of stratification
covariate a new term is added to account for their effects. In Colossus,
this is a Log-Linear term. So the following may be the model used
without stratification:</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    R = \sum_i (x_i \cdot \beta_i)
\end{aligned}
</annotation></semantics></math></p>
<p>Then the stratified model may look like this:</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>R</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>∑</mo><mi>j</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    R = (\sum_i (x_i \cdot \beta_i)) \times (1 + \exp{(\sum_j (x_j \cdot \beta_j))})
\end{aligned}
</annotation></semantics></math></p>
<p>Only results associated with the non-stratified parameters are
returned by default. An average event rate is calculated for every
strata level, which weights the calculated risks.</p>
<p>In code this is done by adding in a list of stratification columns
and using a different function to call the regression. Colossus combines
the list of stratification columns into a single interaction, so it does
not matter if the user provides a list or combines them themselves.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Strat_Col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunPoissonRegression_Strata.html">RunPoissonRegression_Strata</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">pyr</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, strat_col <span class="op">=</span> <span class="va">Strat_Col</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="simplified-model">Simplified Model<a class="anchor" aria-label="anchor" href="#simplified-model"></a>
</h2>
<p>The inclusion of linear subterms, additive models, and multiple terms
means that default Colossus calculates and stores every derivative
assuming that every value is needed. If the equation is log-linear with
one term, then there are many simplifications that can be made. This
option is designed to make those simplifications. In particular having
only one subterm type means that the hazard ratios and their derivatives
can be calculated directly, and the only subterm type being an
exponential means that the logarithm of the hazard ratio in the
Log-Likelihood calculation is simplified. In tests, using the simplified
function was able to save approximately 40% time versus the full code
being used.</p>
<p>Assuming the same general parameters in the other vignettes, the code
is as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Basic.html">RunCoxRegression_Basic</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>,</span>
<span>  <span class="va">keep_constant</span>, <span class="va">a_n</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="non-derivative-calculation">Non-Derivative Calculation<a class="anchor" aria-label="anchor" href="#non-derivative-calculation"></a>
</h2>
<p>Colossus uses Newton’s method to perform the regression, which can
become computationally complex as the number of terms and formula
increases. So Colossus contains functions to calculate only the scores
for a parameter set, and skip the intensive derivative calculations.
These results could be used to perform a bisection method of regression
or plot the dependence of score on parameter values. Colossus in the
current state does not use these functions, but they are left for the
user’s convenience.</p>
<p>The code is similar to previous examples:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Single.html">RunCoxRegression_Single</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunPoissonRegression_Single.html">RunPoissonRegression_Single</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">pyr</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="competing-risks">Competing Risks<a class="anchor" aria-label="anchor" href="#competing-risks"></a>
</h2>
<div class="section level3">
<h3 id="fine-gray">Fine-Gray<a class="anchor" aria-label="anchor" href="#fine-gray"></a>
</h3>
<p>In Cox PH there is an assumption that every individual is recorded
until they have an event or they are naturally censored, and the same
censoring rates are assumed to apply to every individual. These are
violated when there is a competing event occurring. In sensitivity
analysis there are two extremes that can be tested. Either every person
with a competing event is treated as having the event of interest
instead, or they are assumed to never experience the event of interest.
However there are methods to find a more realistic alternative. Colossus
applies the Fine-Gray model for competing risks, which instead weights
the contribution of competing event intervals in future intervals by the
probability they would not have been censored.</p>
<p>As previously established, the risk groups are formed to measure the
probability that an individual survived up to the time and experienced
the event of interest, given that they did not experience an event up to
that time:</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>lim</mo><mrow><mi>Δ</mi><mi>t</mi><mo>→</mo><mn>0</mn></mrow></munder><mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>≤</mo><mi>T</mi><mo>≤</mo><mi>t</mi><mo>+</mo><mi>Δ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>T</mi><mo>≥</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Δ</mi><mi>t</mi></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \lambda(t) = \lim_{\Delta t \to 0} \frac{(P(t \leq T \leq t + \Delta t)\text{ and }(k=1), T \geq t)}{\Delta t}
\end{aligned}
</annotation></semantics></math></p>
<p>The competing risks model adjusts this to be the probability that an
individual survived up to the time and experienced the event of
interest, given that they did not experience an event up to that time OR
they survived up to a previous time and experienced an event:</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>lim</mo><mrow><mi>Δ</mi><mi>t</mi><mo>→</mo><mn>0</mn></mrow></munder><mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>≤</mo><mi>T</mi><mo>≤</mo><mi>t</mi><mo>+</mo><mi>Δ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>≥</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or </mtext><mspace width="0.333em"></mspace></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>&lt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>≠</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Δ</mi><mi>t</mi></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \lambda(t) = \lim_{\Delta t \to 0} \frac{(P(t \leq T \leq t + \Delta t)\text{ and }(k=1), (T \geq t)\text{ or }((T &lt; t)\text{ and }(k \neq 1)))}{\Delta t}
\end{aligned}
</annotation></semantics></math></p>
<p>This means that risks groups would contain both intervals actually at
risk and intervals with competing events treated as if they were at
risk. If we assume that no time-dependent covariates are being used,
then all that remains is to weight the contribution of these competing
events. The goal is to quantify the probability that an interval would
have been uncensored at the new event time given that it was uncensored
up to the competing event time. Colossus handles this by fitting a
survival curve for censoring and using the ratio of surviving proportion
to weight intervals.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>W</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
   W_i(j) = min \left(\frac{S(t_j)}{S(t_i)},1 \right)
\end{aligned}
</annotation></semantics></math></p>
<p>At any given event time, every competing event interval will have a
right interval limit below the event time and every interval without
events will have a right interval limit above the event time. So
competing events will have a weighting below 1 and every other interval
will have a weighting set to 1.</p>
<p>In code, the call is similar to the standard function. The process
for finding a weighting is included below. In this example we assume the
event column, lung, to contain a 0 for no events, 1 for the primary
event, and 2 for the competing event. A ID column is used to determine
which individuals have events and which are censored.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">censor</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">lung</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># censoring column made</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"censor"</span> <span class="co"># event type switched to censoring</span></span>
<span></span>
<span><span class="va">plot_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"name"</span> <span class="op">=</span> <span class="st">"run_2"</span>, <span class="st">"verbose"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="st">"studyID"</span> <span class="op">=</span> <span class="st">"studyID"</span>, <span class="st">"age_unit"</span> <span class="op">=</span> <span class="st">"years"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># modified plotting function used to get censoring weights</span></span>
<span><span class="va">dft</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetCensWeight.html">GetCensWeight</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, plot_options <span class="op">=</span> <span class="va">plot_options</span></span>
<span><span class="op">)</span> <span class="co"># generates a survival curve</span></span>
<span><span class="va">t_ref</span> <span class="op">&lt;-</span> <span class="va">dft</span><span class="op">$</span><span class="va">t</span></span>
<span><span class="va">surv_ref</span> <span class="op">&lt;-</span> <span class="va">dft</span><span class="op">$</span><span class="va">surv</span></span>
<span><span class="va">t_c</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">t1</span></span>
<span><span class="va">cens_weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">t_ref</span>, <span class="va">surv_ref</span>, <span class="va">t_c</span>, rule <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="co"># the surviving proportions used as censoring weight</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"lung"</span> <span class="co"># event switched back</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_CR.html">RunCoxRegression_CR</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>, <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, cens_weight <span class="op">=</span> <span class="va">cens_weight</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="poisson-joint-analysis">Poisson Joint Analysis<a class="anchor" aria-label="anchor" href="#poisson-joint-analysis"></a>
</h3>
<p>For a dataset with multiple outcomes there are often two ways that
Poisson models are fit. Either multiple independent models are fit or
the events are combined and one model is fit to several events. These
methods limit models to be completely independent or identical. The true
model may be a combination of shared terms and terms specific to each
event, which cannot be modeled with these methods. To fit this type of
model a joint analysis method (Cologne, 2019) is available in
Colossus.</p>
<p>Suppose one has a table of person-years, a covariate, and counts for
two events. Assume we are fitting the event rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>)
for each event and have reason to believe that the background rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)
is the same for each event.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Time</th>
<th align="center">a</th>
<th align="center">y</th>
<th align="center">z</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>1</mn></msub><annotation encoding="application/x-tex">a_1</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_1</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mn>1</mn></msub><annotation encoding="application/x-tex">z_1</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>2</mn></msub><annotation encoding="application/x-tex">a_2</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_2</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mn>2</mn></msub><annotation encoding="application/x-tex">z_2</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>λ</mi><mi>y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>β</mi><mo>*</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>y</mi></msub><mo>*</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>λ</mi><mi>z</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>β</mi><mo>*</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>z</mi></msub><mo>*</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \lambda_y(a) = \beta*\exp{(\mu_y*a)}\\
    \lambda_z(a) = \beta*\exp{(\mu_z*a)}
\end{aligned}
</annotation></semantics></math></p>
<p>If one were to solve the equations separately the table would be
split into two tables, each with one event column. The premise of a
joint analysis is to write a model that can be applied to every event,
including a factor covariate to select which event is being solved for.
Then the split tables can be recombined and multiple events can be
solved at once allowing for shared and event-specific parameters.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Time</th>
<th align="center">a</th>
<th align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\alpha_y</annotation></semantics></math></th>
<th align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\alpha_z</annotation></semantics></math></th>
<th align="center">events</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>1</mn></msub><annotation encoding="application/x-tex">a_1</annotation></semantics></math></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_1</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>1</mn></msub><annotation encoding="application/x-tex">a_1</annotation></semantics></math></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mn>1</mn></msub><annotation encoding="application/x-tex">z_1</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>2</mn></msub><annotation encoding="application/x-tex">a_2</annotation></semantics></math></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_2</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>2</mn></msub><annotation encoding="application/x-tex">a_2</annotation></semantics></math></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mn>2</mn></msub><annotation encoding="application/x-tex">z_2</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>α</mi><mi>y</mi></msub><mo>,</mo><msub><mi>α</mi><mi>z</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>β</mi><mo>*</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>y</mi></msub><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>*</mo><msub><mi>α</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>μ</mi><mi>z</mi></msub><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>*</mo><msub><mi>α</mi><mi>z</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \lambda(a,\alpha_y,\alpha_z) = \beta*\exp{(\mu_y*(a*\alpha_y) + \mu_z*(a*\alpha_z))}
\end{aligned}
</annotation></semantics></math></p>
<p>Colossus includes several functions which apply this method, a
function that produces input for a joint analysis regression and
functions which additionally run the regressions. The most general
converts a table and lists of model parameters into the input for a
regression.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"t0"</span> <span class="op">=</span> <span class="va">a</span>, <span class="st">"t1"</span> <span class="op">=</span> <span class="va">b</span>, <span class="st">"e0"</span> <span class="op">=</span> <span class="va">c</span>, <span class="st">"e1"</span> <span class="op">=</span> <span class="va">d</span>, <span class="st">"fac"</span> <span class="op">=</span> <span class="va">e</span><span class="op">)</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="st">"t0"</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="st">"t1"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">t1</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">t0</span></span>
<span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="st">"pyr"</span></span>
<span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e0"</span>, <span class="st">"e1"</span><span class="op">)</span></span></code></pre></div>
<p>Colossus generally accepts a series of vectors to describe the
elements of model. For a joint analysis, Colossus instead expects lists.
Each list is expected to contain vectors for shared elements and
elements specific to each event. Colossus expects the list names to be
either “shared” or the event column names.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">names_e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fac"</span><span class="op">)</span></span>
<span><span class="va">names_e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fac"</span><span class="op">)</span></span>
<span><span class="va">names_shared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t0"</span>, <span class="st">"t0"</span><span class="op">)</span></span>
<span><span class="va">term_n_e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">term_n_e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">term_n_shared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tform_e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span><span class="op">)</span></span>
<span><span class="va">tform_e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span><span class="op">)</span></span>
<span><span class="va">tform_shared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quad_slope"</span>, <span class="st">"loglin_top"</span><span class="op">)</span></span>
<span><span class="va">keep_constant_e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">keep_constant_e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">keep_constant_shared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">a_n_e0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">a_n_e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">a_n_shared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="op">-</span><span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="va">name_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"shared"</span> <span class="op">=</span> <span class="va">names_shared</span>, <span class="st">"e0"</span> <span class="op">=</span> <span class="va">names_e0</span>, <span class="st">"e1"</span> <span class="op">=</span> <span class="va">names_e1</span><span class="op">)</span></span>
<span><span class="va">term_n_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"shared"</span> <span class="op">=</span> <span class="va">term_n_shared</span>, <span class="st">"e0"</span> <span class="op">=</span> <span class="va">term_n_e0</span>, <span class="st">"e1"</span> <span class="op">=</span> <span class="va">term_n_e1</span><span class="op">)</span></span>
<span><span class="va">tform_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"shared"</span> <span class="op">=</span> <span class="va">tform_shared</span>, <span class="st">"e0"</span> <span class="op">=</span> <span class="va">tform_e0</span>, <span class="st">"e1"</span> <span class="op">=</span> <span class="va">tform_e1</span><span class="op">)</span></span>
<span><span class="va">keep_constant_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"shared"</span> <span class="op">=</span> <span class="va">keep_constant_shared</span>,</span>
<span>  <span class="st">"e0"</span> <span class="op">=</span> <span class="va">keep_constant_e0</span>, <span class="st">"e1"</span> <span class="op">=</span> <span class="va">keep_constant_e1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">a_n_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"shared"</span> <span class="op">=</span> <span class="va">a_n_shared</span>, <span class="st">"e0"</span> <span class="op">=</span> <span class="va">a_n_e0</span>, <span class="st">"e1"</span> <span class="op">=</span> <span class="va">a_n_e1</span><span class="op">)</span></span></code></pre></div>
<p>The function returns a list which contains the combined table and
vectors.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Joint_Multiple_Events.html">Joint_Multiple_Events</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">events</span>, <span class="va">name_list</span>, <span class="va">term_n_list</span>,</span>
<span>  <span class="va">tform_list</span>, <span class="va">keep_constant_list</span>, <span class="va">a_n_list</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt;        t0    t1 events    e0    e1   fac   pyr fac_e0 fac_e1</span></span>
<span><span class="co">#&gt;     &lt;num&gt; &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:     0     1      0     1     0     0     1      0      0</span></span>
<span><span class="co">#&gt;  2:     0     1      1     1     0     1     1      1      0</span></span>
<span><span class="co">#&gt;  3:     0     1      2     1     0     1     1      1      0</span></span>
<span><span class="co">#&gt;  4:     1     2      2     1     0     1     1      1      0</span></span>
<span><span class="co">#&gt;  5:     1     2      1     1     0     0     1      0      0</span></span>
<span><span class="co">#&gt;  6:     1     2      0     1     0     0     1      0      0</span></span>
<span><span class="co">#&gt;  7:     0     1      1     0     1     0     1      0      0</span></span>
<span><span class="co">#&gt;  8:     0     1      1     0     1     1     1      0      1</span></span>
<span><span class="co">#&gt;  9:     0     1      0     0     1     1     1      0      1</span></span>
<span><span class="co">#&gt; 10:     1     2      0     0     1     1     1      0      1</span></span>
<span><span class="co">#&gt; 11:     1     2      1     0     1     0     1      0      0</span></span>
<span><span class="co">#&gt; 12:     1     2      1     0     1     0     1      0      0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $names</span></span>
<span><span class="co">#&gt; [1] "t0"     "t0"     "fac_e0" "fac_e1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $term_n</span></span>
<span><span class="co">#&gt; [1] 0 0 0 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tform</span></span>
<span><span class="co">#&gt; [1] "quad_slope" "loglin_top" "loglin"     "loglin"    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $keep_constant</span></span>
<span><span class="co">#&gt; [1] 0 0 0 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $a_n</span></span>
<span><span class="co">#&gt; [1]  0.001 -0.020 -0.100  0.100</span></span></code></pre></div>
<p>These results could be then used as input for any of the available
regression functions. Colossus also includes a wrapper functions to
directly call the Poisson model regression function. This method could
applied to a Cox model assuming every event has the same baseline
hazard. However this is not the intended use, so a wrapper function was
not included.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">der_iden</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">fir</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"ncores"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"lr"</span> <span class="op">=</span> <span class="fl">0.75</span>, <span class="st">"maxiter"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"halfmax"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"epsilon"</span> <span class="op">=</span> <span class="fl">1e-3</span>,</span>
<span>  <span class="st">"dbeta_max"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"deriv_epsilon"</span> <span class="op">=</span> <span class="fl">1e-3</span>, <span class="st">"abs_max"</span> <span class="op">=</span> <span class="fl">1.0</span>, <span class="st">"change_all"</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="st">"dose_abs_max"</span> <span class="op">=</span> <span class="fl">100.0</span>, <span class="st">"verbose"</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="st">"ties"</span> <span class="op">=</span> <span class="st">"breslow"</span>, <span class="st">"double_step"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">guesses_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"maxiter"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"guesses"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"lin_min"</span> <span class="op">=</span> <span class="fl">0.001</span>, <span class="st">"lin_max"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"loglin_min"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, <span class="st">"loglin_max"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"lin_method"</span> <span class="op">=</span> <span class="st">"uniform"</span>, <span class="st">"loglin_method"</span> <span class="op">=</span> <span class="st">"uniform"</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">Strat_Col</span> <span class="op">&lt;-</span> <span class="st">"f"</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunPoissonRegression_Joint_Omnibus.html">RunPoissonRegression_Joint_Omnibus</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, <span class="va">pyr</span>, <span class="va">events</span>, <span class="va">name_list</span>, <span class="va">term_n_list</span>,</span>
<span>  <span class="va">tform_list</span>, <span class="va">keep_constant_list</span>, <span class="va">a_n_list</span>,</span>
<span>  <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span>, strat_col <span class="op">=</span> <span class="va">Strat_Col</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Interpret_Output.html">Interpret_Output</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span>
<span><span class="co">#&gt; Final Results</span></span>
<span><span class="co">#&gt;    Covariate    Subterm Term Number Central Estimate Standard Deviation</span></span>
<span><span class="co">#&gt;       &lt;char&gt;     &lt;char&gt;       &lt;int&gt;            &lt;num&gt;              &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    fac_e0     loglin           0        0.5742948          0.4676073</span></span>
<span><span class="co">#&gt; 2:    fac_e1     loglin           0       -1.0346366          1.0090321</span></span>
<span><span class="co">#&gt; 3:        t0 loglin_top           0       -0.0200000                NaN</span></span>
<span><span class="co">#&gt; 4:        t0 quad_slope           0       -0.1646741                NaN</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Model Used</span></span>
<span><span class="co">#&gt; -2*Log-Likelihood: 20.89,  Deviation: 6.44,  AIC: 14.44,  BIC: 30.83</span></span>
<span><span class="co">#&gt; Iterations run: 6</span></span>
<span><span class="co">#&gt; maximum step size: 1.00e+00, maximum first derivative: 5.12e-04</span></span>
<span><span class="co">#&gt; Analysis converged</span></span>
<span><span class="co">#&gt; Run finished in 0.07 seconds</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------------------|</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="distributed-starts">Distributed starts<a class="anchor" aria-label="anchor" href="#distributed-starts"></a>
</h2>
<p>The distributed start framework is built into both Cox proportional
hazards and Poisson functions and allows the user to provide a list of
multiple starting points. Regressions with 1 guess use the “maxiter”
control option, while regressions with multiple guesses use the
“maxiters” control option to pass a list of iterations per guess. By
default Colossus runs each guess for 1 iteration, picks the best guess,
and then runs the full number of iterations starting at the best guess.
Advanced users can select a different number of iterations for each
guess.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">control</span><span class="op">$</span><span class="va">maxiter</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># runs each (4) starts 1 iteration, and then runs the best 5 iterations</span></span>
<span><span class="va">control</span><span class="op">$</span><span class="va">maxiters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span> <span class="co"># runs each (4) starts 1 iteration, and then runs the best 5 iterations</span></span>
<span><span class="va">control</span><span class="op">$</span><span class="va">maxiters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span> <span class="co"># runs each (4) starts 5 iterations, and then runs the best 5 iterations</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunCoxRegression_Omnibus.html">RunCoxRegression_Omnibus</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">event</span>,</span>
<span>  <span class="va">names</span>, <span class="va">term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>,</span>
<span>  <span class="va">a_n</span>, <span class="va">modelform</span>,</span>
<span>  control <span class="op">=</span> <span class="va">control</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
