<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unified Equation Representation • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unified Equation Representation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Distrib_Starts.html">Distributed Start Framework</a></li>
    <li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Equation_Expression.html">Unified Equation Representation</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Matched_Case_Control.html">Matched Case-Control Logistic Regression</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Unified Equation Representation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/Equation_Expression.Rmd" class="external-link"><code>vignettes/Equation_Expression.Rmd</code></a></small>
      <div class="d-none name"><code>Equation_Expression.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="prospective-feature-presented-for-user-suggestion">Prospective feature, presented for user suggestion<a class="anchor" aria-label="anchor" href="#prospective-feature-presented-for-user-suggestion"></a>
</h2>
<p>The default method to specify a survival model using a series of
vectors can be overly complicated at times. This may not be
straightforward for typical R users and made it complicated to translate
from a model to a script input. A function is provided with Colossus to
help this process by converting from a simple string expression of the
model into the required vectors.</p>
<div class="section level3">
<h3 id="equation-expression">Equation Expression<a class="anchor" aria-label="anchor" href="#equation-expression"></a>
</h3>
<p>The basic idea of this function is to take a string expression,
similar to the model objects in the Survival package, which contains all
of the information required in a more easily read format. This is
intended to serve three functions: simplify the required input, make it
easier to add multiple elements to each subterm, and make it easier to
add factors.</p>
<p>Generally, a survival model is defined by using a Surv object,
initialized with the interval and event columns, and a list of columns.
Because Colossus can handle much more complicated models, the definition
has to be more complicated. Instead of a Surv object, the model is
specified with ‘cox’ or ‘poisson’. Based on the number of entries, the
format of the time interval is assumed. The right side of the equation
is listed similarly. Columns are added to subterm types (loglinear,
linear, plinear). Each subterm has a list of columns and a term number.
Finally, the method to combine terms is added as a separate item
(multiplicative, additive). To prevent any issues with function
definitions, the model equation is stored in a string.</p>
<p class="text-center" style="background-color: aliceblue">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Surv(interval, event)   name + ... + factor(name)</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">’Survival(interval, event)   subterm(name, factor(name), term_number) + ... + term_model()’</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
    \text{Surv(interval, event) ~ name + ... + factor(name)} \\
    \text{'Survival(interval, event) ~ subterm(name, factor(name), term_number) + ... + term_model()'}
\end{aligned}
</annotation></semantics></math></p>
<p>The factor option can be used with or without a baseline specified.
By default, no baseline is used. A baseline can be added by changing
‘factor(name)’ to ‘factor(name;baseline=level)’. If a valid baseline is
used, the proper factor will not be included in the model expression or
the final datatable returned. If an invalid baseline is used a warning
is thrown and no baseline is used.</p>
<p>The following expressions are equivalent.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>, <span class="st">"loglin"</span>, <span class="st">"lin"</span><span class="op">)</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dose0"</span>, <span class="st">"dose1"</span>, <span class="st">"dose2"</span><span class="op">)</span></span>
<span><span class="va">modelform</span> <span class="op">&lt;-</span> <span class="st">"M"</span></span>
<span><span class="va">tstart</span> <span class="op">&lt;-</span> <span class="st">"t0"</span></span>
<span><span class="va">tend</span> <span class="op">&lt;-</span> <span class="st">"t1"</span></span>
<span><span class="va">event</span> <span class="op">&lt;-</span> <span class="st">"lung"</span></span>
<span></span>
<span><span class="va">Model_Eq</span> <span class="op">&lt;-</span> <span class="st">"cox(t0, t1, lung) ~ loglinear(dose0, dose1, 0) + linear(dose2, 1) + multiplicative()"</span></span>
<span><span class="va">Model_Eq</span> <span class="op">&lt;-</span> <span class="st">"cox(t0, t1, lung) ~ loglinear(dose0, dose1) + linear(dose2, 1)"</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"dose0"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"dose1"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"dose2"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Convert_Model_Eq.html">Convert_Model_Eq</a></span><span class="op">(</span><span class="va">Model_Eq</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; $term_n</span></span>
<span><span class="co">#&gt; [1] 0 0 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tform</span></span>
<span><span class="co">#&gt; [1] "loglin" "loglin" "lin"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $names</span></span>
<span><span class="co">#&gt; [1] "dose0" "dose1" "dose2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $modelform</span></span>
<span><span class="co">#&gt; [1] "M"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $survival_model_type</span></span>
<span><span class="co">#&gt; [1] "cox"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $start_age</span></span>
<span><span class="co">#&gt; [1] "t0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $end_age</span></span>
<span><span class="co">#&gt; [1] "t1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $person_year</span></span>
<span><span class="co">#&gt; [1] "NONE"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $event</span></span>
<span><span class="co">#&gt; [1] "lung"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $strata</span></span>
<span><span class="co">#&gt; [1] "NONE"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt;    dose0 dose1 dose2</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:     1     2     3</span></span>
<span><span class="co">#&gt; 2:     2     3     4</span></span>
<span><span class="co">#&gt; 3:     3     4     5</span></span>
<span><span class="co">#&gt; 4:     4     5     6</span></span></code></pre></div>
<p>Different model formulas and subterm types are being added as needed.
Please contact the developer if the methods you want to use have not yet
been added. The following tables cover the subterms and term models that
are currently implemented. Every option listed has multiple equivalent
aliases that all refer to the same subterm or model formula.</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th align="center">Subterm Type</th>
<th align="center">Equivalent Aliases</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">plin</td>
<td align="center">“plin”, “plinear”, “product-linear”</td>
</tr>
<tr class="even">
<td align="center">lin</td>
<td align="center">“lin”, “linear”</td>
</tr>
<tr class="odd">
<td align="center">loglin</td>
<td align="center">“loglin”, “loglinear”, “log-linear”</td>
</tr>
<tr class="even">
<td align="center">loglin_slope/loglin_top</td>
<td align="center">“loglin-dose”, “loglinear-dose”,
“log-linear-dose”</td>
</tr>
<tr class="odd">
<td align="center">lin_slope/lin_top</td>
<td align="center">“lin-dose”, “linear-dose”, “linear-piecewise”</td>
</tr>
<tr class="even">
<td align="center">quad_slope</td>
<td align="center">“quadratic”, “quad”, “quad-dose”,
“quadratic-dose”</td>
</tr>
<tr class="odd">
<td align="center">step_slope/step_int</td>
<td align="center">“step-dose”, “step-piecewise”</td>
</tr>
<tr class="even">
<td align="center">lin_quad_slope/lin_quad_int</td>
<td align="center">“lin-quad-dose”, “linear-quadratic-dose”,
“linear-quadratic-piecewise”</td>
</tr>
<tr class="odd">
<td align="center">lin_exp_slope/lin_exp_int/lin_exp_exp_slope</td>
<td align="center">“lin-exp-dose”, “linear-exponential-dose”,
“linear-exponential-piecewise”</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">Term Type</th>
<th align="center">Equivalent Aliases</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">M</td>
<td align="center">“m”, “me”, “multiplicative”,
“multiplicative-excess”</td>
</tr>
<tr class="even">
<td align="center">A</td>
<td align="center">“a”, “additive”</td>
</tr>
<tr class="odd">
<td align="center">PA</td>
<td align="center">“pa”, “product-additive”</td>
</tr>
<tr class="even">
<td align="center">PAE</td>
<td align="center">“pae”, “product-additive-excess”</td>
</tr>
<tr class="odd">
<td align="center">GMIX</td>
<td align="center">“gmix”,“geometric-mixture”</td>
</tr>
<tr class="even">
<td align="center">GMIX-R</td>
<td align="center">“gmix-r”,“relative-geometric-mixture”</td>
</tr>
<tr class="odd">
<td align="center">GMIX-E</td>
<td align="center">“gmix-e”,“excess-geometric-mixture”</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
