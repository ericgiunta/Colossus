<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generating Person-Count and Person-Time Tables • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating Person-Count and Person-Time Tables">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt_Distrib_Starts.html">Distributed Start Framework</a></li>
    <li><a class="dropdown-item" href="../articles/Alt_Run_Opt.html">Alternative Regression Options</a></li>
    <li><a class="dropdown-item" href="../articles/Control_Options.html">List of Control Options</a></li>
    <li><a class="dropdown-item" href="../articles/count_time_tables.html">Generating Person-Count and Person-Time Tables</a></li>
    <li><a class="dropdown-item" href="../articles/Dose_Formula_Inputs.html">Dose Response Formula Terms</a></li>
    <li><a class="dropdown-item" href="../articles/Equation_Expression.html">Unified Equation Representation</a></li>
    <li><a class="dropdown-item" href="../articles/Excess_and_Predicted_Cases.html">Excess and Predicted Cases</a></li>
    <li><a class="dropdown-item" href="../articles/Grad_Hess.html">Gradient and Hessian Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/Multi_Realization.html">Multiple Realization Methods</a></li>
    <li><a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for Plotting and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Script_Comparison_Epicure.html">Script comparisons with 32-bit Epicure</a></li>
    <li><a class="dropdown-item" href="../articles/SMR_Analysis.html">SMR Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Starting-Description.html">Colossus Description</a></li>
    <li><a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time Dependent Covariate Use</a></li>
    <li><a class="dropdown-item" href="../articles/Wald_and_Log_Bound.html">Confidence Interval Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generating Person-Count and Person-Time Tables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/main/vignettes/count_time_tables.Rmd" class="external-link"><code>vignettes/count_time_tables.Rmd</code></a></small>
      <div class="d-none name"><code>count_time_tables.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericgiunta.github.io/Colossus/" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="general-purpose">General Purpose<a class="anchor" aria-label="anchor" href="#general-purpose"></a>
</h2>
<p>Before performing a regression on rate or hazard ratio, it is often
important to look at a summary of the data. It can be very informative
to break columns into categories and summarize the number of event or
average column value in each category. Colossus offers two function
designed to create summary tables, Event_Count_Gen and Event_Time_Gen
which create person-count tables and person-time table respectively. The
following sections will cover generally how to use each function and
what different needs are met.</p>
<div class="section level3">
<h3 id="person-count-tables">Person-Count Tables<a class="anchor" aria-label="anchor" href="#person-count-tables"></a>
</h3>
<p>A person count table is the simplest way to summarize a table. This
assumes you have a columns you want to break into categories and columns
you want to summarize. Lets start with a very simple example. Suppose we
have a dataset tracking the number of apples and oranges people bought,
the number of hands they used to carry their bag, and if the bag ripped
or not.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">oranges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">hands</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  <span class="st">"apples"</span> <span class="op">=</span> <span class="va">apples</span>,</span>
<span>  <span class="st">"oranges"</span> <span class="op">=</span> <span class="va">oranges</span>,</span>
<span>  <span class="st">"rip"</span> <span class="op">=</span> <span class="va">rip</span>,</span>
<span>  <span class="st">"hands"</span> <span class="op">=</span> <span class="va">hands</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Suppose we want to split our dataset up by the number of each fruit,
count the number of ripped bags in each category, and figure out the
average number of hands used. We would start out by defining how we want
to split the categories. There are two general ways to define the
intervals, with a single string or a list of upper and lower bounds.
Lets start with the string representation. The string is expected to
alternate number and delimiter, either / or ], which split the upper and
lower bounds for each interval. Every interval in this format includes
the lower bound. The interval includes the upper bound if ] is used, and
does not otherwise. So the interval [2,5) is equivalent to “2/5” and the
interval [5,8] is equivalent to “5]8”. This method uses each triplet
sequentially, so the categories will cover every value that falls
between the first and last number listed. The list notation is very
similar. There are 2 values required in the list and 1 optional value.
The list has to have vectors titled lower and upper, which are the lower
and upper bounds for each interval. This method can include gaps.
Similarly to the string version, the lower bound is always included and
the upper bound is included if the upper bound entry includes ]. The
list option allows the categories to be labeled instead of being
automatically numbered. A third list titled name can be provided to
label each category. Lets suppose we want to break the apples column
into the intervals: [0, 3), [3, 5), [5,7] and break our oranges column
into the intervals: [-1,3), [3,6), [6,10) with the labels: few, good,
and excessive. That would look like the following code. This splits each
category into 3 levels, and in total 9 combinations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apple_category</span> <span class="op">&lt;-</span> <span class="st">"0/3/5]7"</span></span>
<span><span class="va">orange_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"few"</span>, <span class="st">"good"</span>, <span class="st">"excessive"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"apples"</span> <span class="op">=</span> <span class="va">apple_category</span>,</span>
<span>  <span class="st">"oranges"</span> <span class="op">=</span> <span class="va">orange_category</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we define what summary variables we want. Once again, we define a
list. Every item in the list is named with the column it is applied to
and contains a string specifying what summary method to use. There are
two options supported currently: count and mean, which will sum or mean
of the column in each category. One can also provide a new name for the
summary column by listing the method as “option AS name”. Otherwise the
grouped table will use the original column name for the summary column
name. So lets suppose we wanted to take the sum of ripped bags and name
it “dropped” and take the mean of the hands column.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"rip"</span> <span class="op">=</span> <span class="st">"count AS dropped"</span>, <span class="st">"hands"</span> <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<p>The final step is to run the function. The function returns two
items, the grouped data and a summary of the category intervals. The
category intervals should be checked to verify that the intervals match
what are expected.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Event_Count_Gen.html">Event_Count_Gen</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">categ</span>, <span class="va">event</span><span class="op">)</span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt;    apples_category oranges_category COUNT dropped hands</span></span>
<span><span class="co">#&gt;             &lt;char&gt;           &lt;char&gt; &lt;int&gt;   &lt;num&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:               1                1     8       3  1.50</span></span>
<span><span class="co">#&gt; 2:               2                2     5       3  2.00</span></span>
<span><span class="co">#&gt; 3:               3                3     4       3  1.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds</span></span>
<span><span class="co">#&gt; $bounds$apples_category</span></span>
<span><span class="co">#&gt; [1] " [0, 3) [3, 5) [5, 7]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$oranges_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 6) [6, 10)"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="person-time-tables">Person-Time Tables<a class="anchor" aria-label="anchor" href="#person-time-tables"></a>
</h3>
<p>The previous method treats every row as being weighted the same. In
many cases every row has some measure of time which we may want to use.
That is the fundamental difference between the person count tables and
person time tables, the inclusion of time. The code used to generate a
person time table is very similar to the person count table, with
several important differences. The first is that the data should have
time columns. Similar to the Cox model options in Colossus, the data
should have an entry column, exit column, or both. These would denote
the scenario where every interval ends at the same point, starts at the
same point, or have different start and stopping times. This method
currently only supports day/month/year information which are combined
into complete dates. The Event_Time_Gen function uses a list to input
the time columns. This list should have entry and exit items if needed,
each list should have a column name for the year, month, and day columns
if needed. The dates will default to 1/1/1900 if not provided. The
person-year list can also contain a unit, defaulted to years.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>,</span>
<span>  <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span>, <span class="fl">1900</span></span>
<span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1901</span>, <span class="fl">1902</span>, <span class="fl">1903</span>, <span class="fl">1904</span>, <span class="fl">1905</span>, <span class="fl">1906</span>, <span class="fl">1907</span>, <span class="fl">1903</span>, <span class="fl">1904</span>,</span>
<span>  <span class="fl">1903</span>, <span class="fl">1904</span>, <span class="fl">1910</span>, <span class="fl">1903</span>, <span class="fl">1904</span>, <span class="fl">1903</span>, <span class="fl">1904</span>, <span class="fl">1910</span></span>
<span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  <span class="st">"a"</span> <span class="op">=</span> <span class="va">a</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="va">b</span>, <span class="st">"c"</span> <span class="op">=</span> <span class="va">c</span>,</span>
<span>  <span class="st">"d"</span> <span class="op">=</span> <span class="va">d</span>, <span class="st">"e"</span> <span class="op">=</span> <span class="va">e</span>, <span class="st">"f"</span> <span class="op">=</span> <span class="va">f</span>,</span>
<span>  <span class="st">"g"</span> <span class="op">=</span> <span class="va">g</span>, <span class="st">"h"</span> <span class="op">=</span> <span class="va">h</span>, <span class="st">"i"</span> <span class="op">=</span> <span class="va">i</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  entry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"f"</span>, month <span class="op">=</span> <span class="st">"e"</span>, day <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span>,</span>
<span>  exit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"i"</span>, month <span class="op">=</span> <span class="st">"h"</span>, day <span class="op">=</span> <span class="st">"g"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"years"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The second major difference is the possible use of time categories.
Time categories are set by a vectors of of day, month, and year of each
interval splitting point. So intervals changing every 2 days could be
expressed by “day=c(1,3,5,…)”. Time categories are unique in that each
row can correspond to multiple time categories, so the duration of each
row in each time category is kept to distinguish which rows are only
partially in each time interval. If a time category is not provided,
then the full duration of each row is used for person-year
calculations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"a"</span> <span class="op">=</span> <span class="st">"-1/3/5]7"</span>,</span>
<span>  <span class="st">"b"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"time AS time_bin"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"day"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="st">"month"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="st">"year"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1899</span>, <span class="fl">1903</span>, <span class="fl">1910</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The final difference is that person-time tables make a distinction
between events and summaries. The summary list is nearly identical to
the event list in the person-count function. The only difference is that
a weighted_mean option is added. This is the mean of the group weighted
by person-years. The event list for the person-time table function is
used to determine which time categories the event columns are assigned
to. Based on the relative row intervals and category intervals, each row
can be part of multiple time categories. However, the event is only
assigned to the time category containing the endpoint of the row
interval.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"c"</span> <span class="op">=</span> <span class="st">"count AS cases"</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="st">"weighted_mean AS b_weighted"</span><span class="op">)</span></span>
<span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p>Finally the function is run. Similar to the person-count table
function, the function returns the grouped table and list of category
boundaries.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  entry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"f"</span>, month <span class="op">=</span> <span class="st">"e"</span>, day <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span>,</span>
<span>  exit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"i"</span>, month <span class="op">=</span> <span class="st">"h"</span>, day <span class="op">=</span> <span class="st">"g"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"years"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event_Time_Gen.html">Event_Time_Gen</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">pyr</span>, <span class="va">categ</span>, <span class="va">summary</span>, <span class="va">events</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt;     a_category b_category time_bin AT_RISK        PYR cases b_weighted</span></span>
<span><span class="co">#&gt;         &lt;char&gt;     &lt;char&gt;   &lt;char&gt;   &lt;int&gt;      &lt;num&gt; &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:          1       high        1       1  2.9952088     0   6.000000</span></span>
<span><span class="co">#&gt;  2:          1       high        2       1  0.2600958     0   6.000000</span></span>
<span><span class="co">#&gt;  3:          1        low        1       5 12.4791239     1   1.413339</span></span>
<span><span class="co">#&gt;  4:          1        low        2       3 14.4257358     0   1.485291</span></span>
<span><span class="co">#&gt;  5:          1     medium        1       2  5.9876797     0   3.999543</span></span>
<span><span class="co">#&gt;  6:          1     medium        2       2  1.5167693     1   4.664260</span></span>
<span><span class="co">#&gt;  7:          2        low        1       1  2.9979466     0   2.000000</span></span>
<span><span class="co">#&gt;  8:          2        low        2       1  1.2566735     0   2.000000</span></span>
<span><span class="co">#&gt;  9:          2     medium        1       4 11.8083504     0   3.993276</span></span>
<span><span class="co">#&gt; 10:          2     medium        2       4  5.7056810     3   4.175144</span></span>
<span><span class="co">#&gt; 11:          3       high        1       2  5.8234086     0   6.499765</span></span>
<span><span class="co">#&gt; 12:          3       high        2       2  7.6824093     2   6.554170</span></span>
<span><span class="co">#&gt; 13:          3        low        1       1  2.9130732     0   2.000000</span></span>
<span><span class="co">#&gt; 14:          3        low        2       1  0.2546201     1   2.000000</span></span>
<span><span class="co">#&gt; 15:          3     medium        1       1  2.9103354     0   3.000000</span></span>
<span><span class="co">#&gt; 16:          3     medium        2       1  1.2566735     0   3.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds</span></span>
<span><span class="co">#&gt; $bounds$a_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 5) [5, 7]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$b_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 6) [6, 10)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$time_bin</span></span>
<span><span class="co">#&gt; [1] " [1899-01-01 to 1903-01-01] [1903-01-01 to 1910-01-01]"</span></span>
<span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  entry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"f"</span>, month <span class="op">=</span> <span class="st">"e"</span>, day <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span>,</span>
<span>  exit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"i"</span>, month <span class="op">=</span> <span class="st">"h"</span>, day <span class="op">=</span> <span class="st">"g"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"months"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event_Time_Gen.html">Event_Time_Gen</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">pyr</span>, <span class="va">categ</span>, <span class="va">summary</span>, <span class="va">events</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt;     a_category b_category time_bin AT_RISK        PYR cases b_weighted</span></span>
<span><span class="co">#&gt;         &lt;char&gt;     &lt;char&gt;   &lt;char&gt;   &lt;int&gt;      &lt;num&gt; &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:          1       high        1       1  35.942505     0   6.000000</span></span>
<span><span class="co">#&gt;  2:          1       high        2       1   3.121150     0   6.000000</span></span>
<span><span class="co">#&gt;  3:          1        low        1       5 149.749487     1   1.413339</span></span>
<span><span class="co">#&gt;  4:          1        low        2       3 173.108830     0   1.485291</span></span>
<span><span class="co">#&gt;  5:          1     medium        1       2  71.852156     0   3.999543</span></span>
<span><span class="co">#&gt;  6:          1     medium        2       2  18.201232     1   4.664260</span></span>
<span><span class="co">#&gt;  7:          2        low        1       1  35.975359     0   2.000000</span></span>
<span><span class="co">#&gt;  8:          2        low        2       1  15.080082     0   2.000000</span></span>
<span><span class="co">#&gt;  9:          2     medium        1       4 141.700205     0   3.993276</span></span>
<span><span class="co">#&gt; 10:          2     medium        2       4  68.468172     3   4.175144</span></span>
<span><span class="co">#&gt; 11:          3       high        1       2  69.880903     0   6.499765</span></span>
<span><span class="co">#&gt; 12:          3       high        2       2  92.188912     2   6.554170</span></span>
<span><span class="co">#&gt; 13:          3        low        1       1  34.956879     0   2.000000</span></span>
<span><span class="co">#&gt; 14:          3        low        2       1   3.055441     1   2.000000</span></span>
<span><span class="co">#&gt; 15:          3     medium        1       1  34.924025     0   3.000000</span></span>
<span><span class="co">#&gt; 16:          3     medium        2       1  15.080082     0   3.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds</span></span>
<span><span class="co">#&gt; $bounds$a_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 5) [5, 7]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$b_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 6) [6, 10)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$time_bin</span></span>
<span><span class="co">#&gt; [1] " [1899-01-01 to 1903-01-01] [1903-01-01 to 1910-01-01]"</span></span>
<span><span class="va">pyr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  entry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"f"</span>, month <span class="op">=</span> <span class="st">"e"</span>, day <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span>,</span>
<span>  exit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"i"</span>, month <span class="op">=</span> <span class="st">"h"</span>, day <span class="op">=</span> <span class="st">"g"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"days"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event_Time_Gen.html">Event_Time_Gen</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">pyr</span>, <span class="va">categ</span>, <span class="va">summary</span>, <span class="va">events</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt;     a_category b_category time_bin AT_RISK   PYR cases b_weighted</span></span>
<span><span class="co">#&gt;         &lt;char&gt;     &lt;char&gt;   &lt;char&gt;   &lt;int&gt; &lt;num&gt; &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:          1       high        1       1  1094     0   6.000000</span></span>
<span><span class="co">#&gt;  2:          1       high        2       1    95     0   6.000000</span></span>
<span><span class="co">#&gt;  3:          1        low        1       5  4558     1   1.413339</span></span>
<span><span class="co">#&gt;  4:          1        low        2       3  5269     0   1.485291</span></span>
<span><span class="co">#&gt;  5:          1     medium        1       2  2187     0   3.999543</span></span>
<span><span class="co">#&gt;  6:          1     medium        2       2   554     1   4.664260</span></span>
<span><span class="co">#&gt;  7:          2        low        1       1  1095     0   2.000000</span></span>
<span><span class="co">#&gt;  8:          2        low        2       1   459     0   2.000000</span></span>
<span><span class="co">#&gt;  9:          2     medium        1       4  4313     0   3.993276</span></span>
<span><span class="co">#&gt; 10:          2     medium        2       4  2084     3   4.175144</span></span>
<span><span class="co">#&gt; 11:          3       high        1       2  2127     0   6.499765</span></span>
<span><span class="co">#&gt; 12:          3       high        2       2  2806     2   6.554170</span></span>
<span><span class="co">#&gt; 13:          3        low        1       1  1064     0   2.000000</span></span>
<span><span class="co">#&gt; 14:          3        low        2       1    93     1   2.000000</span></span>
<span><span class="co">#&gt; 15:          3     medium        1       1  1063     0   3.000000</span></span>
<span><span class="co">#&gt; 16:          3     medium        2       1   459     0   3.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds</span></span>
<span><span class="co">#&gt; $bounds$a_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 5) [5, 7]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$b_category</span></span>
<span><span class="co">#&gt; [1] " [-1, 3) [3, 6) [6, 10)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bounds$time_bin</span></span>
<span><span class="co">#&gt; [1] " [1899-01-01 to 1903-01-01] [1903-01-01 to 1910-01-01]"</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
