<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Colossus">
<title>Dose_Response_Formula_Terms • Colossus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dose_Response_Formula_Terms">
<meta property="og:description" content="Colossus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Colossus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Alt_Distrib_Starts.html">Distributed_Start_Framework</a>
    <a class="dropdown-item" href="../articles/Alt_Run_opt.html">Alternative_Regression_Options</a>
    <a class="dropdown-item" href="../articles/Plotting_And_Analysis.html">Functions for plotting and analysis</a>
    <a class="dropdown-item" href="../articles/Time_Dep_Cov.html">Time_Dependent_Covariate_Use</a>
    <a class="dropdown-item" href="../articles/dose_formula_inputs.html">Dose_Response_Formula_Terms</a>
    <a class="dropdown-item" href="../articles/starting-description.html">Colossus_Description</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ericgiunta/Colossus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Dose_Response_Formula_Terms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ericgiunta/Colossus/blob/HEAD/vignettes/dose_formula_inputs.Rmd" class="external-link"><code>vignettes/dose_formula_inputs.Rmd</code></a></small>
      <div class="d-none name"><code>dose_formula_inputs.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ericgiunta/Colossus" class="external-link">Colossus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="dose-response-formula">Dose Response Formula<a class="anchor" aria-label="anchor" href="#dose-response-formula"></a>
</h2>
<p>As previously discussed, Colossus features a term composed of the sum
of multiple linear and non-linear term which can be used to define many
dose response curves used in radiation epidemiology. These terms are
referred to as dose response terms, but there is nothing prohibiting
them from being used for non-dose covariates. The following formula are
available, reproduced from the starting description vignette.</p>
<p class="text-center" style="background-color: aliceblue">
<span class="math display">\[
\begin{aligned}
    S_{NL}=\sum_i (\alpha_i \times \exp(x_i \cdot \beta_i)) + \sum_i
(\beta_i \cdot (x_i)^2) + \sum_i F_{LT} + \sum_i F_{STP} + \sum_i F_{LQ}
+ \sum_i F_{LEXP}\\
    F_{LT} = \begin{cases} \alpha_i \cdot (x-\beta_i) &amp;
(x&gt;\beta_i) \\ 0 &amp;\text{else} \end{cases}\\
    F_{STP} = \begin{cases} \alpha_i &amp; (x&gt;\beta_i) \\ 0
&amp;\text{else} \end{cases}\\
    F_{LQ} = \begin{cases} \beta_i \cdot x &amp; (x&gt;\alpha_i) \\
\lambda_i \cdot x^2 + \nu_i &amp;\text{else} \end{cases}\\
    F_{LEXP} = \begin{cases} \beta_i \cdot x &amp; (x&gt;\alpha_i) \\
\lambda_i - \exp{(\nu_i + \mu \cdot x)} &amp;\text{else} \end{cases}\\
    T_j=S_{LL,j} \times S_{L,j} \times S_{PL,j} \times S_{NL,j}
\end{aligned}
\]</span>
</p>
<p>For every subterm type there are between 1 and 3 parameters which
fully define the curve. The Linear-Quadratic and Linear-Exponential
curves are continuously-differentiable, so there are only 2-3 parameters
which can be set.</p>
<p class="text-center" style="background-color: aliceblue">
<span class="math display">\[
\begin{aligned}
    \lambda_{LQ} = \beta_{LQ}/(2\alpha_{LQ})\\
    \nu_{LQ} = (\beta_{LQ}*\alpha_{LQ})/2\\
    \nu_{LEXP} =
\ln(\beta_{LEXP})-\ln(\mu_{LEXP})+\mu_{LEXP}*\alpha_{LEXP}\\
    \lambda_{LEXP} =
\beta_{LEXP}*\alpha_{LEXP}+exp(\nu_{LEXP}-\mu_{LEXP}*\alpha_{LEXP})
\end{aligned}
\]</span>
</p>
</div>
<div class="section level2">
<h2 id="using-the-different-subterms">Using The Different subterms<a class="anchor" aria-label="anchor" href="#using-the-different-subterms"></a>
</h2>
<table class="table">
<colgroup>
<col width="31%">
<col width="34%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="center">Subterm</th>
<th align="center">tform Entry</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Exponential</td>
<td align="center">loglin_top</td>
<td align="center">parameter in the exponent of the term, <span class="math inline">\(\beta_i\)</span>
</td>
</tr>
<tr class="even">
<td align="center">Exponential</td>
<td align="center">loglin_slope</td>
<td align="center">parameter multiplied by the exponential assumed to be
1 if not given, <span class="math inline">\(\alpha_i\)</span>
</td>
</tr>
<tr class="odd">
<td align="center">Linear Threshold</td>
<td align="center">lin_slope</td>
<td align="center">slope for the linear term, <span class="math inline">\(\alpha_i\)</span>
</td>
</tr>
<tr class="even">
<td align="center">Linear Threshold</td>
<td align="center">lin_int</td>
<td align="center">intercept for the linear term, <span class="math inline">\(\beta_i\)</span>
</td>
</tr>
<tr class="odd">
<td align="center">Step Function</td>
<td align="center">step_slope</td>
<td align="center">step function value, <span class="math inline">\(\alpha_i\)</span>
</td>
</tr>
<tr class="even">
<td align="center">Step Function</td>
<td align="center">step_int</td>
<td align="center">step function intercept, <span class="math inline">\(\beta_i\)</span>
</td>
</tr>
<tr class="odd">
<td align="center">Quadratic</td>
<td align="center">quad_slope</td>
<td align="center">parameter multiplied by the squared value, <span class="math inline">\(\beta_i\)</span>
</td>
</tr>
<tr class="even">
<td align="center">Linear-Exponential</td>
<td align="center">lin_exp_slope</td>
<td align="center">Linear slope term, <span class="math inline">\(\beta_i\)</span>
</td>
</tr>
<tr class="odd">
<td align="center">Linear-Exponential</td>
<td align="center">lin_exp_int</td>
<td align="center">Intercept between linear to exponential, <span class="math inline">\(\alpha_i\)</span>
</td>
</tr>
<tr class="even">
<td align="center">Linear-Exponential</td>
<td align="center">lin_exp_exp_slope</td>
<td align="center">Slope term in the exponential, <span class="math inline">\(\mu_i\)</span>
</td>
</tr>
<tr class="odd">
<td align="center">Linear-Quadratic</td>
<td align="center">lin_quad_slope</td>
<td align="center">Linear slope term, <span class="math inline">\(\beta_i\)</span>
</td>
</tr>
<tr class="even">
<td align="center">Linear-Quadratic</td>
<td align="center">lin_quad_int</td>
<td align="center">Intercept between linear to quadratic, <span class="math inline">\(\alpha_i\)</span>
</td>
</tr>
</tbody>
</table>
<p>The linear-exponential and linear-quadratic curves must be either
completely fixed or completely free. In contrast the exponential, linear
threshold, and step function curves can be partially fixed. The
exponential term can be provided with only the covariate in the exponent
and assume the magnitude to be 1. The linear threshold and step
functions can be provided a fixed threshold covariate, which can be used
to define a linear-no-threshold model or a combination of linear and
step functions with a known threshold.</p>
<p>One issue with these dose response formulas is that the order is
important. For instance, loglin_slope should be listed prior to
loglin_top if both are used. The slope for the Linear Threshold and Step
Functions should be given prior to the intercepts. Slopes are listed
prior to intercept for the Linear-Quadratic and Linear-Exponential
models and lin_exp_exp_slope is listed last. The “Correct_Formula_Order”
function has been provided to handle the correct order. Colossus
automatically calls this function prior to regression.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Term_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loglin"</span>,<span class="st">'quad_slope'</span>,<span class="st">'lin'</span>, <span class="st">"lin_int"</span>, <span class="st">"lin_slope"</span><span class="op">)</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"a"</span>,<span class="st">"a"</span>,<span class="st">"a"</span>,<span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Correct_Formula_Order.html">Correct_Formula_Order</a></span><span class="op">(</span><span class="va">Term_n</span>, <span class="va">tform</span>, <span class="va">keep_constant</span>, <span class="va">a_n</span>, <span class="va">names</span><span class="op">)</span></span>
<span><span class="va">Term_n</span> <span class="op">&lt;-</span> <span class="va">val</span><span class="op">$</span><span class="va">Term_n</span></span>
<span><span class="va">tform</span> <span class="op">&lt;-</span> <span class="va">val</span><span class="op">$</span><span class="va">tform</span></span>
<span><span class="va">keep_constant</span> <span class="op">&lt;-</span> <span class="va">val</span><span class="op">$</span><span class="va">keep_constant</span></span>
<span><span class="va">a_n</span> <span class="op">&lt;-</span> <span class="va">val</span><span class="op">$</span><span class="va">a_n</span></span>
<span><span class="va">der_iden</span> <span class="op">&lt;-</span> <span class="va">val</span><span class="op">$</span><span class="va">der_iden</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="va">val</span><span class="op">$</span><span class="va">names</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Eric Giunta, NASA, NCRP, NRC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
